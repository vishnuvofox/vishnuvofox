const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-raw-P5HygWKU.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/javascript_compressed-CViLVm5f.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();function bind(e,t){return function(){return e.apply(t,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(e=>t=>{const o=toString.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=e=>(e=e.toLowerCase(),t=>kindOf(t)===e),typeOfTest=e=>t=>typeof t===e,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&isFunction(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&isArrayBuffer(e.buffer),t}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=e=>e!==null&&typeof e=="object",isBoolean=e=>e===!0||e===!1,isPlainObject=e=>{if(kindOf(e)!=="object")return!1;const t=getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject(e)&&isFunction(e.pipe),isFormData=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||isFunction(e.append)&&((t=kindOf(e))==="formdata"||t==="object"&&isFunction(e.toString)&&e.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let r,n;if(typeof e!="object"&&(e=[e]),isArray(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{const s=o?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let a;for(r=0;r<i;r++)a=s[r],t.call(null,e[a],a,e)}}function findKey(e,t){t=t.toLowerCase();const o=Object.keys(e);let r=o.length,n;for(;r-- >0;)if(n=o[r],t===n.toLowerCase())return n;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=e=>!isUndefined(e)&&e!==_global;function merge(){const{caseless:e}=isContextDefined(this)&&this||{},t={},o=(r,n)=>{const s=e&&findKey(t,n)||n;isPlainObject(t[s])&&isPlainObject(r)?t[s]=merge(t[s],r):isPlainObject(r)?t[s]=merge({},r):isArray(r)?t[s]=r.slice():t[s]=r};for(let r=0,n=arguments.length;r<n;r++)arguments[r]&&forEach(arguments[r],o);return t}const extend=(e,t,o,{allOwnKeys:r}={})=>(forEach(t,(n,s)=>{o&&isFunction(n)?e[s]=bind(n,o):e[s]=n},{allOwnKeys:r}),e),stripBOM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits=(e,t,o,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},toFlatObject=(e,t,o,r)=>{let n,s,i;const a={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)i=n[s],(!r||r(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=o!==!1&&getPrototypeOf(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},endsWith=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const r=e.indexOf(t,o);return r!==-1&&r===o},toArray=e=>{if(!e)return null;if(isArray(e))return e;let t=e.length;if(!isNumber(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},isTypedArray=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const s=n.value;t.call(e,s[0],s[1])}},matchAll=(e,t)=>{let o;const r=[];for(;(o=e.exec(t))!==null;)r.push(o);return r},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,r,n){return r.toUpperCase()+n}),hasOwnProperty=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),r={};forEach(o,(n,s)=>{let i;(i=t(n,s,e))!==!1&&(r[s]=i||n)}),Object.defineProperties(e,r)},freezeMethods=e=>{reduceDescriptors(e,(t,o)=>{if(isFunction(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const r=e[o];if(isFunction(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},toObjectSet=(e,t)=>{const o={},r=n=>{n.forEach(s=>{o[s]=!0})};return isArray(e)?r(e):r(String(e).split(t)),o},noop=()=>{},toFiniteNumber=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(e=16,t=ALPHABET.ALPHA_DIGIT)=>{let o="";const{length:r}=t;for(;e--;)o+=t[Math.random()*r|0];return o};function isSpecCompliantForm(e){return!!(e&&isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const toJSONObject=e=>{const t=new Array(10),o=(r,n)=>{if(isObject(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[n]=r;const s=isArray(r)?[]:{};return forEach(r,(i,a)=>{const u=o(i,n+1);!isUndefined(u)&&(s[a]=u)}),t[n]=void 0,s}}return r};return o(e,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=e=>e&&(isObject(e)||isFunction(e))&&isFunction(e.then)&&isFunction(e.catch),_setImmediate=((e,t)=>e?setImmediate:t?((o,r)=>(_global.addEventListener("message",({source:n,data:s})=>{n===_global&&s===o&&r.length&&r.shift()()},!1),n=>{r.push(n),_global.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError(e,t,o,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(e,t,o,r,n,s)=>{const i=Object.create(prototype$1);return utils$1.toFlatObject(e,i,function(u){return u!==Error.prototype},a=>a!=="isAxiosError"),AxiosError.call(i,e.message,t,o,r,n),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const httpAdapter=null;function isVisitable(e){return utils$1.isPlainObject(e)||utils$1.isArray(e)}function removeBrackets(e){return utils$1.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,t,o){return e?e.concat(t).map(function(n,s){return n=removeBrackets(n),!o&&s?"["+n+"]":n}).join(o?".":""):t}function isFlatArray(e){return utils$1.isArray(e)&&!e.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(t){return/^is[A-Z]/.test(t)});function toFormData(e,t,o){if(!utils$1.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=utils$1.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,y){return!utils$1.isUndefined(y[p])});const r=o.metaTokens,n=o.visitor||d,s=o.dots,i=o.indexes,u=(o.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(t);if(!utils$1.isFunction(n))throw new TypeError("visitor must be a function");function c(l){if(l===null)return"";if(utils$1.isDate(l))return l.toISOString();if(!u&&utils$1.isBlob(l))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(l)||utils$1.isTypedArray(l)?u&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function d(l,p,y){let b=l;if(l&&!y&&typeof l=="object"){if(utils$1.endsWith(p,"{}"))p=r?p:p.slice(0,-2),l=JSON.stringify(l);else if(utils$1.isArray(l)&&isFlatArray(l)||(utils$1.isFileList(l)||utils$1.endsWith(p,"[]"))&&(b=utils$1.toArray(l)))return p=removeBrackets(p),b.forEach(function(O,C){!(utils$1.isUndefined(O)||O===null)&&t.append(i===!0?renderKey([p],C,s):i===null?p:p+"[]",c(O))}),!1}return isVisitable(l)?!0:(t.append(renderKey(y,p,s),c(l)),!1)}const h=[],S=Object.assign(predicates,{defaultVisitor:d,convertValue:c,isVisitable});function v(l,p){if(!utils$1.isUndefined(l)){if(h.indexOf(l)!==-1)throw Error("Circular reference detected in "+p.join("."));h.push(l),utils$1.forEach(l,function(b,N){(!(utils$1.isUndefined(b)||b===null)&&n.call(t,b,utils$1.isString(N)?N.trim():N,p,S))===!0&&v(b,p?p.concat(N):[N])}),h.pop()}}if(!utils$1.isObject(e))throw new TypeError("data must be an object");return v(e),t}function encode$1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function AxiosURLSearchParams(e,t){this._pairs=[],e&&toFormData(e,this,t)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(t,o){this._pairs.push([t,o])};prototype.toString=function(t){const o=t?function(r){return t.call(this,r,encode$1)}:encode$1;return this._pairs.map(function(n){return o(n[0])+"="+o(n[1])},"").join("&")};function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,t,o){if(!t)return e;const r=o&&o.encode||encode,n=o&&o.serialize;let s;if(n?s=n(t,o):s=utils$1.isURLSearchParams(t)?t.toString():new AxiosURLSearchParams(t,o).toString(r),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class InterceptorManager{constructor(){this.handlers=[]}use(t,o,r){return this.handlers.push({fulfilled:t,rejected:o,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){utils$1.forEach(this.handlers,function(r){r!==null&&t(r)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(e,t){return toFormData(e,new platform.classes.URLSearchParams,Object.assign({visitor:function(o,r,n,s){return platform.isNode&&utils$1.isBuffer(o)?(this.append(r,o.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function parsePropPath(e){return utils$1.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function arrayToObject(e){const t={},o=Object.keys(e);let r;const n=o.length;let s;for(r=0;r<n;r++)s=o[r],t[s]=e[s];return t}function formDataToJSON(e){function t(o,r,n,s){let i=o[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),u=s>=o.length;return i=!i&&utils$1.isArray(n)?n.length:i,u?(utils$1.hasOwnProp(n,i)?n[i]=[n[i],r]:n[i]=r,!a):((!n[i]||!utils$1.isObject(n[i]))&&(n[i]=[]),t(o,r,n[i],s)&&utils$1.isArray(n[i])&&(n[i]=arrayToObject(n[i])),!a)}if(utils$1.isFormData(e)&&utils$1.isFunction(e.entries)){const o={};return utils$1.forEachEntry(e,(r,n)=>{t(parsePropPath(r),n,o,0)}),o}return null}function stringifySafely(e,t,o){if(utils$1.isString(e))try{return(t||JSON.parse)(e),utils$1.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(o||JSON.stringify)(e)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const r=o.getContentType()||"",n=r.indexOf("application/json")>-1,s=utils$1.isObject(t);if(s&&utils$1.isHTMLForm(t)&&(t=new FormData(t)),utils$1.isFormData(t))return n?JSON.stringify(formDataToJSON(t)):t;if(utils$1.isArrayBuffer(t)||utils$1.isBuffer(t)||utils$1.isStream(t)||utils$1.isFile(t)||utils$1.isBlob(t)||utils$1.isReadableStream(t))return t;if(utils$1.isArrayBufferView(t))return t.buffer;if(utils$1.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(t,this.formSerializer).toString();if((a=utils$1.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return toFormData(a?{"files[]":t}:t,u&&new u,this.formSerializer)}}return s||n?(o.setContentType("application/json",!1),stringifySafely(t)):t}],transformResponse:[function(t){const o=this.transitional||defaults.transitional,r=o&&o.forcedJSONParsing,n=this.responseType==="json";if(utils$1.isResponse(t)||utils$1.isReadableStream(t))return t;if(t&&utils$1.isString(t)&&(r&&!this.responseType||n)){const i=!(o&&o.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?AxiosError.from(a,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],e=>{defaults.headers[e]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=e=>{const t={};let o,r,n;return e&&e.split(`
`).forEach(function(i){n=i.indexOf(":"),o=i.substring(0,n).trim().toLowerCase(),r=i.substring(n+1).trim(),!(!o||t[o]&&ignoreDuplicateOf[o])&&(o==="set-cookie"?t[o]?t[o].push(r):t[o]=[r]:t[o]=t[o]?t[o]+", "+r:r)}),t},$internals=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return e===!1||e==null?e:utils$1.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=o.exec(e);)t[r[1]]=r[2];return t}const isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,t,o,r,n){if(utils$1.isFunction(r))return r.call(this,t,o);if(n&&(t=o),!!utils$1.isString(t)){if(utils$1.isString(r))return t.indexOf(r)!==-1;if(utils$1.isRegExp(r))return r.test(t)}}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,r)=>o.toUpperCase()+r)}function buildAccessors(e,t){const o=utils$1.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+o,{value:function(n,s,i){return this[r].call(this,t,n,s,i)},configurable:!0})})}class AxiosHeaders{constructor(t){t&&this.set(t)}set(t,o,r){const n=this;function s(a,u,c){const d=normalizeHeader(u);if(!d)throw new Error("header name must be a non-empty string");const h=utils$1.findKey(n,d);(!h||n[h]===void 0||c===!0||c===void 0&&n[h]!==!1)&&(n[h||u]=normalizeValue(a))}const i=(a,u)=>utils$1.forEach(a,(c,d)=>s(c,d,u));if(utils$1.isPlainObject(t)||t instanceof this.constructor)i(t,o);else if(utils$1.isString(t)&&(t=t.trim())&&!isValidHeaderName(t))i(parseHeaders(t),o);else if(utils$1.isHeaders(t))for(const[a,u]of t.entries())s(u,a,r);else t!=null&&s(o,t,r);return this}get(t,o){if(t=normalizeHeader(t),t){const r=utils$1.findKey(this,t);if(r){const n=this[r];if(!o)return n;if(o===!0)return parseTokens(n);if(utils$1.isFunction(o))return o.call(this,n,r);if(utils$1.isRegExp(o))return o.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=normalizeHeader(t),t){const r=utils$1.findKey(this,t);return!!(r&&this[r]!==void 0&&(!o||matchHeaderValue(this,this[r],r,o)))}return!1}delete(t,o){const r=this;let n=!1;function s(i){if(i=normalizeHeader(i),i){const a=utils$1.findKey(r,i);a&&(!o||matchHeaderValue(r,r[a],a,o))&&(delete r[a],n=!0)}}return utils$1.isArray(t)?t.forEach(s):s(t),n}clear(t){const o=Object.keys(this);let r=o.length,n=!1;for(;r--;){const s=o[r];(!t||matchHeaderValue(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){const o=this,r={};return utils$1.forEach(this,(n,s)=>{const i=utils$1.findKey(r,s);if(i){o[i]=normalizeValue(n),delete o[s];return}const a=t?formatHeader(s):String(s).trim();a!==s&&delete o[s],o[a]=normalizeValue(n),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return utils$1.forEach(this,(r,n)=>{r!=null&&r!==!1&&(o[n]=t&&utils$1.isArray(r)?r.join(", "):r)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const r=new this(t);return o.forEach(n=>r.set(n)),r}static accessor(t){const r=(this[$internals]=this[$internals]={accessors:{}}).accessors,n=this.prototype;function s(i){const a=normalizeHeader(i);r[a]||(buildAccessors(n,i),r[a]=!0)}return utils$1.isArray(t)?t.forEach(s):s(t),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[o]=r}}});utils$1.freezeMethods(AxiosHeaders);function transformData(e,t){const o=this||defaults,r=t||o,n=AxiosHeaders.from(r.headers);let s=r.data;return utils$1.forEach(e,function(a){s=a.call(o,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function isCancel(e){return!!(e&&e.__CANCEL__)}function CanceledError(e,t,o){AxiosError.call(this,e??"canceled",AxiosError.ERR_CANCELED,t,o),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(e,t,o){const r=o.config.validateStatus;!o.status||!r||r(o.status)?e(o):t(new AxiosError("Request failed with status code "+o.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function parseProtocol(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function speedometer(e,t){e=e||10;const o=new Array(e),r=new Array(e);let n=0,s=0,i;return t=t!==void 0?t:1e3,function(u){const c=Date.now(),d=r[s];i||(i=c),o[n]=u,r[n]=c;let h=s,S=0;for(;h!==n;)S+=o[h++],h=h%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),c-i<t)return;const v=d&&c-d;return v?Math.round(S*1e3/v):void 0}}function throttle(e,t){let o=0,r=1e3/t,n,s;const i=(c,d=Date.now())=>{o=d,n=null,s&&(clearTimeout(s),s=null),e.apply(null,c)};return[(...c)=>{const d=Date.now(),h=d-o;h>=r?i(c,d):(n=c,s||(s=setTimeout(()=>{s=null,i(n)},r-h)))},()=>n&&i(n)]}const progressEventReducer=(e,t,o=3)=>{let r=0;const n=speedometer(50,250);return throttle(s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,u=i-r,c=n(u),d=i<=a;r=i;const h={loaded:i,total:a,progress:a?i/a:void 0,bytes:u,rate:c||void 0,estimated:c&&a&&d?(a-i)/c:void 0,event:s,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(h)},o)},progressEventDecorator=(e,t)=>{const o=e!=null;return[r=>t[0]({lengthComputable:o,total:e,loaded:r}),t[1]]},asyncDecorator=e=>(...t)=>utils$1.asap(()=>e(...t)),isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const t=platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent),o=document.createElement("a");let r;function n(s){let i=s;return t&&(o.setAttribute("href",i),i=o.href),o.setAttribute("href",i),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:o.pathname.charAt(0)==="/"?o.pathname:"/"+o.pathname}}return r=n(window.location.href),function(i){const a=utils$1.isString(i)?n(i):i;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}(),cookies=platform.hasStandardBrowserEnv?{write(e,t,o,r,n,s){const i=[e+"="+encodeURIComponent(t)];utils$1.isNumber(o)&&i.push("expires="+new Date(o).toGMTString()),utils$1.isString(r)&&i.push("path="+r),utils$1.isString(n)&&i.push("domain="+n),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function buildFullPath(e,t){return e&&!isAbsoluteURL(t)?combineURLs(e,t):t}const headersToObject=e=>e instanceof AxiosHeaders?{...e}:e;function mergeConfig(e,t){t=t||{};const o={};function r(c,d,h){return utils$1.isPlainObject(c)&&utils$1.isPlainObject(d)?utils$1.merge.call({caseless:h},c,d):utils$1.isPlainObject(d)?utils$1.merge({},d):utils$1.isArray(d)?d.slice():d}function n(c,d,h){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return r(void 0,c,h)}else return r(c,d,h)}function s(c,d){if(!utils$1.isUndefined(d))return r(void 0,d)}function i(c,d){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function a(c,d,h){if(h in t)return r(c,d);if(h in e)return r(void 0,c)}const u={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(c,d)=>n(headersToObject(c),headersToObject(d),!0)};return utils$1.forEach(Object.keys(Object.assign({},e,t)),function(d){const h=u[d]||n,S=h(e[d],t[d],d);utils$1.isUndefined(S)&&h!==a||(o[d]=S)}),o}const resolveConfig=e=>{const t=mergeConfig({},e);let{data:o,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:s,headers:i,auth:a}=t;t.headers=i=AxiosHeaders.from(i),t.url=buildURL(buildFullPath(t.baseURL,t.url),e.params,e.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let u;if(utils$1.isFormData(o)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((u=i.getContentType())!==!1){const[c,...d]=u?u.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...d].join("; "))}}if(platform.hasStandardBrowserEnv&&(r&&utils$1.isFunction(r)&&(r=r(t)),r||r!==!1&&isURLSameOrigin(t.url))){const c=n&&s&&cookies.read(s);c&&i.set(n,c)}return t},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(e){return new Promise(function(o,r){const n=resolveConfig(e);let s=n.data;const i=AxiosHeaders.from(n.headers).normalize();let{responseType:a,onUploadProgress:u,onDownloadProgress:c}=n,d,h,S,v,l;function p(){v&&v(),l&&l(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(n.method.toUpperCase(),n.url,!0),y.timeout=n.timeout;function b(){if(!y)return;const O=AxiosHeaders.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),f={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:O,config:e,request:y};settle(function(L){o(L),p()},function(L){r(L),p()},f),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(r(new AxiosError("Request aborted",AxiosError.ECONNABORTED,e,y)),y=null)},y.onerror=function(){r(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let C=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const f=n.transitional||transitionalDefaults;n.timeoutErrorMessage&&(C=n.timeoutErrorMessage),r(new AxiosError(C,f.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,e,y)),y=null},s===void 0&&i.setContentType(null),"setRequestHeader"in y&&utils$1.forEach(i.toJSON(),function(C,f){y.setRequestHeader(f,C)}),utils$1.isUndefined(n.withCredentials)||(y.withCredentials=!!n.withCredentials),a&&a!=="json"&&(y.responseType=n.responseType),c&&([S,l]=progressEventReducer(c,!0),y.addEventListener("progress",S)),u&&y.upload&&([h,v]=progressEventReducer(u),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",v)),(n.cancelToken||n.signal)&&(d=O=>{y&&(r(!O||O.type?new CanceledError(null,e,y):O),y.abort(),y=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const N=parseProtocol(n.url);if(N&&platform.protocols.indexOf(N)===-1){r(new AxiosError("Unsupported protocol "+N+":",AxiosError.ERR_BAD_REQUEST,e));return}y.send(s||null)})},composeSignals=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let r=new AbortController,n;const s=function(c){if(!n){n=!0,a();const d=c instanceof Error?c:this.reason;r.abort(d instanceof AxiosError?d:new CanceledError(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,s(new AxiosError(`timeout ${t} of ms exceeded`,AxiosError.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:u}=r;return u.unsubscribe=()=>utils$1.asap(a),u}},streamChunk=function*(e,t){let o=e.byteLength;if(!t||o<t){yield e;return}let r=0,n;for(;r<o;)n=r+t,yield e.slice(r,n),r=n},readBytes=async function*(e,t){for await(const o of readStream(e))yield*streamChunk(o,t)},readStream=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:r}=await t.read();if(o)break;yield r}}finally{await t.cancel()}},trackStream=(e,t,o,r)=>{const n=readBytes(e,t);let s=0,i,a=u=>{i||(i=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:c,value:d}=await n.next();if(c){a(),u.close();return}let h=d.byteLength;if(o){let S=s+=h;o(S)}u.enqueue(new Uint8Array(d))}catch(c){throw a(c),c}},cancel(u){return a(u),n.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),test=(e,...t)=>{try{return!!e(...t)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let e=!1;const t=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(e=>e.body)};isFetchSupported&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!resolvers[t]&&(resolvers[t]=utils$1.isFunction(e[t])?o=>o[t]():(o,r)=>{throw new AxiosError(`Response type '${t}' is not supported`,AxiosError.ERR_NOT_SUPPORT,r)})})})(new Response);const getBodyLength=async e=>{if(e==null)return 0;if(utils$1.isBlob(e))return e.size;if(utils$1.isSpecCompliantForm(e))return(await new Request(platform.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(e)||utils$1.isArrayBuffer(e))return e.byteLength;if(utils$1.isURLSearchParams(e)&&(e=e+""),utils$1.isString(e))return(await encodeText(e)).byteLength},resolveBodyLength=async(e,t)=>{const o=utils$1.toFiniteNumber(e.getContentLength());return o??getBodyLength(t)},fetchAdapter=isFetchSupported&&(async e=>{let{url:t,method:o,data:r,signal:n,cancelToken:s,timeout:i,onDownloadProgress:a,onUploadProgress:u,responseType:c,headers:d,withCredentials:h="same-origin",fetchOptions:S}=resolveConfig(e);c=c?(c+"").toLowerCase():"text";let v=composeSignals([n,s&&s.toAbortSignal()],i),l;const p=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let y;try{if(u&&supportsRequestStream&&o!=="get"&&o!=="head"&&(y=await resolveBodyLength(d,r))!==0){let f=new Request(t,{method:"POST",body:r,duplex:"half"}),E;if(utils$1.isFormData(r)&&(E=f.headers.get("content-type"))&&d.setContentType(E),f.body){const[L,m]=progressEventDecorator(y,progressEventReducer(asyncDecorator(u)));r=trackStream(f.body,DEFAULT_CHUNK_SIZE,L,m)}}utils$1.isString(h)||(h=h?"include":"omit");const b="credentials"in Request.prototype;l=new Request(t,{...S,signal:v,method:o.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:b?h:void 0});let N=await fetch(l);const O=supportsResponseStream&&(c==="stream"||c==="response");if(supportsResponseStream&&(a||O&&p)){const f={};["status","statusText","headers"].forEach(w=>{f[w]=N[w]});const E=utils$1.toFiniteNumber(N.headers.get("content-length")),[L,m]=a&&progressEventDecorator(E,progressEventReducer(asyncDecorator(a),!0))||[];N=new Response(trackStream(N.body,DEFAULT_CHUNK_SIZE,L,()=>{m&&m(),p&&p()}),f)}c=c||"text";let C=await resolvers[utils$1.findKey(resolvers,c)||"text"](N,e);return!O&&p&&p(),await new Promise((f,E)=>{settle(f,E,{data:C,headers:AxiosHeaders.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:l})})}catch(b){throw p&&p(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,l),{cause:b.cause||b}):AxiosError.from(b,b&&b.code,e,l)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const renderReason=e=>`- ${e}`,isResolvedHandle=e=>utils$1.isFunction(e)||e===null||e===!1,adapters={getAdapter:e=>{e=utils$1.isArray(e)?e:[e];const{length:t}=e;let o,r;const n={};for(let s=0;s<t;s++){o=e[s];let i;if(r=o,!isResolvedHandle(o)&&(r=knownAdapters[(i=String(o)).toLowerCase()],r===void 0))throw new AxiosError(`Unknown adapter '${i}'`);if(r)break;n[i||"#"+s]=r}if(!r){const s=Object.entries(n).map(([a,u])=>`adapter ${a} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(renderReason).join(`
`):" "+renderReason(s[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:knownAdapters};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError(null,e)}function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=AxiosHeaders.from(e.headers),e.data=transformData.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(e.adapter||defaults.adapter)(e).then(function(r){return throwIfCancellationRequested(e),r.data=transformData.call(e,e.transformResponse,r),r.headers=AxiosHeaders.from(r.headers),r},function(r){return isCancel(r)||(throwIfCancellationRequested(e),r&&r.response&&(r.response.data=transformData.call(e,e.transformResponse,r.response),r.response.headers=AxiosHeaders.from(r.response.headers))),Promise.reject(r)})}const VERSION="1.7.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{validators$1[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const deprecatedWarnings={};validators$1.transitional=function(t,o,r){function n(s,i){return"[Axios v"+VERSION+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,a)=>{if(t===!1)throw new AxiosError(n(i," has been removed"+(o?" in "+o:"")),AxiosError.ERR_DEPRECATED);return o&&!deprecatedWarnings[i]&&(deprecatedWarnings[i]=!0,console.warn(n(i," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(s,i,a):!0}};function assertOptions(e,t,o){if(typeof e!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let n=r.length;for(;n-- >0;){const s=r[n],i=t[s];if(i){const a=e[s],u=a===void 0||i(a,s,e);if(u!==!0)throw new AxiosError("option "+s+" must be "+u,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new AxiosError("Unknown option "+s,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(t){this.defaults=t,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(t,o){try{return await this._request(t,o)}catch(r){if(r instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=mergeConfig(this.defaults,o);const{transitional:r,paramsSerializer:n,headers:s}=o;r!==void 0&&validator.assertOptions(r,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),n!=null&&(utils$1.isFunction(n)?o.paramsSerializer={serialize:n}:validator.assertOptions(n,{encode:validators.function,serialize:validators.function},!0)),o.method=(o.method||this.defaults.method||"get").toLowerCase();let i=s&&utils$1.merge(s.common,s[o.method]);s&&utils$1.forEach(["delete","get","head","post","put","patch","common"],l=>{delete s[l]}),o.headers=AxiosHeaders.concat(i,s);const a=[];let u=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(o)===!1||(u=u&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let d,h=0,S;if(!u){const l=[dispatchRequest.bind(this),void 0];for(l.unshift.apply(l,a),l.push.apply(l,c),S=l.length,d=Promise.resolve(o);h<S;)d=d.then(l[h++],l[h++]);return d}S=a.length;let v=o;for(h=0;h<S;){const l=a[h++],p=a[h++];try{v=l(v)}catch(y){p.call(this,y);break}}try{d=dispatchRequest.call(this,v)}catch(l){return Promise.reject(l)}for(h=0,S=c.length;h<S;)d=d.then(c[h++],c[h++]);return d}getUri(t){t=mergeConfig(this.defaults,t);const o=buildFullPath(t.baseURL,t.url);return buildURL(o,t.params,t.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(t){Axios.prototype[t]=function(o,r){return this.request(mergeConfig(r||{},{method:t,url:o,data:(r||{}).data}))}});utils$1.forEach(["post","put","patch"],function(t){function o(r){return function(s,i,a){return this.request(mergeConfig(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}Axios.prototype[t]=o(),Axios.prototype[t+"Form"]=o(!0)});class CancelToken{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(s){o=s});const r=this;this.promise.then(n=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](n);r._listeners=null}),this.promise.then=n=>{let s;const i=new Promise(a=>{r.subscribe(a),s=a}).then(n);return i.cancel=function(){r.unsubscribe(s)},i},t(function(s,i,a){r.reason||(r.reason=new CanceledError(s,i,a),o(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=r=>{t.abort(r)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new CancelToken(function(n){t=n}),cancel:t}}}function spread(e){return function(o){return e.apply(null,o)}}function isAxiosError(e){return utils$1.isObject(e)&&e.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([e,t])=>{HttpStatusCode[t]=e});function createInstance(e){const t=new Axios(e),o=bind(Axios.prototype.request,t);return utils$1.extend(o,Axios.prototype,t,{allOwnKeys:!0}),utils$1.extend(o,t,null,{allOwnKeys:!0}),o.create=function(n){return createInstance(mergeConfig(e,n))},o}const axios=createInstance(defaults);axios.Axios=Axios;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(t){return Promise.all(t)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders;axios.formToJSON=e=>formDataToJSON(utils$1.isHTMLForm(e)?new FormData(e):e);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode;axios.default=axios;const apiClient=axios.create({baseURL:"https://fdcp655z6l.execute-api.ap-south-1.amazonaws.com/Prod",timeout:1e5,headers:{"Content-Type":"application/json"}});apiClient.interceptors.request.use(e=>{const t=localStorage.getItem("token")?.split(",")[0];return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));apiClient.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(window.location.href="https://d134xln0rcdwz6.cloudfront.net/dataconfigurations/blocklydefinition"),Promise.reject(e)));function getUserRole(){apiClient.get("api/Dashboard/GetDashboardDetails").then(e=>{localStorage.setItem("userRole",e.data.role)}).catch(e=>{localStorage.removeItem("userRole","")})}function storeParamsInLocalStorage(){const e=new URLSearchParams(window.location.search),t=e.get("blocklyId"),o=e.get("templateId"),r=e.get("token");return o&&r?(localStorage.setItem("blocklyId",t),localStorage.setItem("templateId",o),localStorage.setItem("token",r),!0):(localStorage.removeItem("blocklyId"),localStorage.removeItem("templateId"),localStorage.removeItem("token"),alert("No Auth"),!1)}storeParamsInLocalStorage();getUserRole();localStorage.getItem("token")?.split(",")[0];const blocklyConfigId=localStorage.getItem("blocklyId"),templateId=localStorage.getItem("templateId"),userRole=localStorage.getItem("userRole"),scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(t,o,r){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=s?.nonce||s?.getAttribute("nonce");n=Promise.all(o.map(a=>{if(a=assetsURL(a),a in seen)return;seen[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":scriptRel,u||(d.as="script",d.crossOrigin=""),d.href=a,i&&d.setAttribute("nonce",i),document.head.appendChild(d),u)return new Promise((h,S)=>{d.addEventListener("load",h),d.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${a}`)))})}))}return n.then(()=>t()).catch(s=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s})};let Blockly$2;Blockly$2=await __vitePreload(()=>import("./browser-raw-P5HygWKU.js").then(e=>e.b),__vite__mapDeps([0,1]));const BlocklyClone={...Blockly$2},biBlocks=await __vitePreload(()=>import("./bi_blockly-JU1Ofyci.js"),[]);BlocklyClone.Blocks=biBlocks?.default(BlocklyClone);const blocklyJS=await __vitePreload(()=>import("./javascript_compressed-CViLVm5f.js").then(e=>e.j),__vite__mapDeps([2,1]));blocklyJS.default(BlocklyClone);const biBlocksJS=await __vitePreload(()=>import("./bi_blockly-cfbj7yJm.js"),[]);biBlocksJS.default(BlocklyClone);window.Blockly=BlocklyClone;var XMLParser;(()=>{var e={696:r=>{const n=/^[-+]?0x[a-fA-F0-9]+$/,s=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const i={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};r.exports=function(a,u={}){if(u=Object.assign({},i,u),!a||typeof a!="string")return a;let c=a.trim();if(u.skipLike!==void 0&&u.skipLike.test(c))return a;if(u.hex&&n.test(c))return Number.parseInt(c,16);{const h=s.exec(c);if(h){const S=h[1],v=h[2];let l=((d=h[3])&&d.indexOf(".")!==-1&&((d=d.replace(/0+$/,""))==="."?d="0":d[0]==="."?d="0"+d:d[d.length-1]==="."&&(d=d.substr(0,d.length-1))),d);const p=h[4]||h[6];if(!u.leadingZeros&&v.length>0&&S&&c[2]!=="."||!u.leadingZeros&&v.length>0&&!S&&c[1]!==".")return a;{const y=Number(c),b=""+y;return b.search(/[eE]/)!==-1||p?u.eNotation?y:a:c.indexOf(".")!==-1?b==="0"&&l===""||b===l||S&&b==="-"+l?y:a:v?l===b||S+l===b?y:a:c===b||c===S+b?y:a}}return a}var d}},825:(r,n)=>{var s=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",i="["+s+"]["+s+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",a=new RegExp("^"+i+"$");n.isExist=function(u){return u!==void 0},n.isEmptyObject=function(u){return Object.keys(u).length===0},n.merge=function(u,c,d){if(c)for(var h=Object.keys(c),S=h.length,v=0;v<S;v++)u[h[v]]=d==="strict"?[c[h[v]]]:c[h[v]]},n.getValue=function(u){return n.isExist(u)?u:""},n.isName=function(u){return a.exec(u)!=null},n.getAllMatches=function(u,c){for(var d=[],h=c.exec(u);h;){var S=[];S.startIndex=c.lastIndex-h[0].length;for(var v=h.length,l=0;l<v;l++)S.push(h[l]);d.push(S),h=c.exec(u)}return d},n.nameRegexp=i},631:(r,n,s)=>{var i=s(825),a={allowBooleanAttributes:!1,unpairedTags:[]};function u(f){return f===" "||f==="	"||f===`
`||f==="\r"}function c(f,E){for(var L=E;E<f.length;E++)if(!(f[E]!="?"&&f[E]!=" ")){var m=f.substr(L,E-L);if(E>5&&m==="xml")return b("InvalidXml","XML declaration allowed only at the start of the document.",O(f,E));if(f[E]=="?"&&f[E+1]==">"){E++;break}}return E}function d(f,E){if(f.length>E+5&&f[E+1]==="-"&&f[E+2]==="-"){for(E+=3;E<f.length;E++)if(f[E]==="-"&&f[E+1]==="-"&&f[E+2]===">"){E+=2;break}}else if(f.length>E+8&&f[E+1]==="D"&&f[E+2]==="O"&&f[E+3]==="C"&&f[E+4]==="T"&&f[E+5]==="Y"&&f[E+6]==="P"&&f[E+7]==="E"){var L=1;for(E+=8;E<f.length;E++)if(f[E]==="<")L++;else if(f[E]===">"&&--L==0)break}else if(f.length>E+9&&f[E+1]==="["&&f[E+2]==="C"&&f[E+3]==="D"&&f[E+4]==="A"&&f[E+5]==="T"&&f[E+6]==="A"&&f[E+7]==="["){for(E+=8;E<f.length;E++)if(f[E]==="]"&&f[E+1]==="]"&&f[E+2]===">"){E+=2;break}}return E}n.validate=function(f,E){E=Object.assign({},a,E);var L,m=[],w=!1,T=!1;f[0]==="\uFEFF"&&(f=f.substr(1));for(var g=0;g<f.length;g++)if(f[g]==="<"&&f[g+1]==="?"){if((g=c(f,g+=2)).err)return g}else{if(f[g]!=="<"){if(u(f[g]))continue;return b("InvalidChar","char '"+f[g]+"' is not expected.",O(f,g))}var x=g;if(f[++g]==="!"){g=d(f,g);continue}var k=!1;f[g]==="/"&&(k=!0,g++);for(var _="";g<f.length&&f[g]!==">"&&f[g]!==" "&&f[g]!=="	"&&f[g]!==`
`&&f[g]!=="\r";g++)_+=f[g];if((_=_.trim())[_.length-1]==="/"&&(_=_.substring(0,_.length-1),g--),L=_,!i.isName(L))return b("InvalidTag",_.trim().length===0?"Invalid space after '<'.":"Tag '"+_+"' is an invalid name.",O(f,g));var D=v(f,g);if(D===!1)return b("InvalidAttr","Attributes for '"+_+"' have open quote.",O(f,g));var A=D.value;if(g=D.index,A[A.length-1]==="/"){var P=g-A.length,I=p(A=A.substring(0,A.length-1),E);if(I!==!0)return b(I.err.code,I.err.msg,O(f,P+I.err.line));w=!0}else if(k){if(!D.tagClosed)return b("InvalidTag","Closing tag '"+_+"' doesn't have proper closing.",O(f,g));if(A.trim().length>0)return b("InvalidTag","Closing tag '"+_+"' can't have attributes or invalid starting.",O(f,x));if(m.length===0)return b("InvalidTag","Closing tag '"+_+"' has not been opened.",O(f,x));var B=m.pop();if(_!==B.tagName){var H=O(f,B.tagStartPos);return b("InvalidTag","Expected closing tag '"+B.tagName+"' (opened in line "+H.line+", col "+H.col+") instead of closing tag '"+_+"'.",O(f,x))}m.length==0&&(T=!0)}else{var U=p(A,E);if(U!==!0)return b(U.err.code,U.err.msg,O(f,g-A.length+U.err.line));if(T===!0)return b("InvalidXml","Multiple possible root nodes found.",O(f,g));E.unpairedTags.indexOf(_)!==-1||m.push({tagName:_,tagStartPos:x}),w=!0}for(g++;g<f.length;g++)if(f[g]==="<"){if(f[g+1]==="!"){g=d(f,++g);continue}if(f[g+1]!=="?")break;if((g=c(f,++g)).err)return g}else if(f[g]==="&"){var F=y(f,g);if(F==-1)return b("InvalidChar","char '&' is not expected.",O(f,g));g=F}else if(T===!0&&!u(f[g]))return b("InvalidXml","Extra text at the end",O(f,g));f[g]==="<"&&g--}return w?m.length==1?b("InvalidTag","Unclosed tag '"+m[0].tagName+"'.",O(f,m[0].tagStartPos)):!(m.length>0)||b("InvalidXml","Invalid '"+JSON.stringify(m.map(function(j){return j.tagName}),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):b("InvalidXml","Start tag expected.",1)};var h='"',S="'";function v(f,E){for(var L="",m="",w=!1;E<f.length;E++){if(f[E]===h||f[E]===S)m===""?m=f[E]:m!==f[E]||(m="");else if(f[E]===">"&&m===""){w=!0;break}L+=f[E]}return m===""&&{value:L,index:E,tagClosed:w}}var l=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function p(f,E){for(var L=i.getAllMatches(f,l),m={},w=0;w<L.length;w++){if(L[w][1].length===0)return b("InvalidAttr","Attribute '"+L[w][2]+"' has no space in starting.",C(L[w]));if(L[w][3]!==void 0&&L[w][4]===void 0)return b("InvalidAttr","Attribute '"+L[w][2]+"' is without value.",C(L[w]));if(L[w][3]===void 0&&!E.allowBooleanAttributes)return b("InvalidAttr","boolean attribute '"+L[w][2]+"' is not allowed.",C(L[w]));var T=L[w][2];if(!N(T))return b("InvalidAttr","Attribute '"+T+"' is an invalid name.",C(L[w]));if(m.hasOwnProperty(T))return b("InvalidAttr","Attribute '"+T+"' is repeated.",C(L[w]));m[T]=1}return!0}function y(f,E){if(f[++E]===";")return-1;if(f[E]==="#")return function(m,w){var T=/\d/;for(m[w]==="x"&&(w++,T=/[\da-fA-F]/);w<m.length;w++){if(m[w]===";")return w;if(!m[w].match(T))break}return-1}(f,++E);for(var L=0;E<f.length;E++,L++)if(!(f[E].match(/\w/)&&L<20)){if(f[E]===";")break;return-1}return E}function b(f,E,L){return{err:{code:f,msg:E,line:L.line||L,col:L.col}}}function N(f){return i.isName(f)}function O(f,E){var L=f.substring(0,E).split(/\r?\n/);return{line:L.length,col:L[L.length-1].length+1}}function C(f){return f.startIndex+f[1].length}},785:(r,n,s)=>{var i=s(825);function a(l,p){for(var y="";p<l.length&&l[p]!=="'"&&l[p]!=='"';p++)y+=l[p];if((y=y.trim()).indexOf(" ")!==-1)throw new Error("External entites are not supported");for(var b=l[p++],N="";p<l.length&&l[p]!==b;p++)N+=l[p];return[y,N,p]}function u(l,p){return l[p+1]==="!"&&l[p+2]==="-"&&l[p+3]==="-"}function c(l,p){return l[p+1]==="!"&&l[p+2]==="E"&&l[p+3]==="N"&&l[p+4]==="T"&&l[p+5]==="I"&&l[p+6]==="T"&&l[p+7]==="Y"}function d(l,p){return l[p+1]==="!"&&l[p+2]==="E"&&l[p+3]==="L"&&l[p+4]==="E"&&l[p+5]==="M"&&l[p+6]==="E"&&l[p+7]==="N"&&l[p+8]==="T"}function h(l,p){return l[p+1]==="!"&&l[p+2]==="A"&&l[p+3]==="T"&&l[p+4]==="T"&&l[p+5]==="L"&&l[p+6]==="I"&&l[p+7]==="S"&&l[p+8]==="T"}function S(l,p){return l[p+1]==="!"&&l[p+2]==="N"&&l[p+3]==="O"&&l[p+4]==="T"&&l[p+5]==="A"&&l[p+6]==="T"&&l[p+7]==="I"&&l[p+8]==="O"&&l[p+9]==="N"}function v(l){if(i.isName(l))return l;throw new Error("Invalid entity name "+l)}r.exports=function(l,p){var y={};if(l[p+3]!=="O"||l[p+4]!=="C"||l[p+5]!=="T"||l[p+6]!=="Y"||l[p+7]!=="P"||l[p+8]!=="E")throw new Error("Invalid Tag instead of DOCTYPE");p+=9;for(var b=1,N=!1,O=!1;p<l.length;p++)if(l[p]!=="<"||O)if(l[p]===">"){if(O?l[p-1]==="-"&&l[p-2]==="-"&&(O=!1,b--):b--,b===0)break}else l[p]==="["?N=!0:l[p];else{if(N&&c(l,p)){var C=a(l,(p+=7)+1);entityName=C[0],val=C[1],p=C[2],val.indexOf("&")===-1&&(y[v(entityName)]={regx:RegExp("&"+entityName+";","g"),val})}else if(N&&d(l,p))p+=8;else if(N&&h(l,p))p+=8;else if(N&&S(l,p))p+=9;else{if(!u)throw new Error("Invalid DOCTYPE");O=!0}b++}if(b!==0)throw new Error("Unclosed DOCTYPE");return{entities:y,i:p}}},7:(r,n)=>{var s={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(i,a){return a},attributeValueProcessor:function(i,a){return a},stopNodes:[],alwaysCreateTextNode:!1,isArray:function(){return!1},commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(i,a,u){return i}};n.buildOptions=function(i){return Object.assign({},s,i)},n.defaultOptions=s},731:(r,n,s)=>{var i=s(825),a=s(501),u=s(785),c=s(696);function d(m){for(var w=Object.keys(m),T=0;T<w.length;T++){var g=w[T];this.lastEntities[g]={regex:new RegExp("&"+g+";","g"),val:m[g]}}}function h(m,w,T,g,x,k,_){if(m!==void 0&&(this.options.trimValues&&!g&&(m=m.trim()),m.length>0)){_||(m=this.replaceEntitiesValue(m));var D=this.options.tagValueProcessor(w,m,T,x,k);return D==null?m:typeof D!=typeof m||D!==m?D:this.options.trimValues||m.trim()===m?L(m,this.options.parseTagValue,this.options.numberParseOptions):m}}function S(m){if(this.options.removeNSPrefix){var w=m.split(":"),T=m.charAt(0)==="/"?"/":"";if(w[0]==="xmlns")return"";w.length===2&&(m=T+w[1])}return m}var v=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function l(m,w,T){if(!this.options.ignoreAttributes&&typeof m=="string"){for(var g=i.getAllMatches(m,v),x=g.length,k={},_=0;_<x;_++){var D=this.resolveNameSpace(g[_][1]),A=g[_][4],P=this.options.attributeNamePrefix+D;if(D.length)if(this.options.transformAttributeName&&(P=this.options.transformAttributeName(P)),P==="__proto__"&&(P="#__proto__"),A!==void 0){this.options.trimValues&&(A=A.trim()),A=this.replaceEntitiesValue(A);var I=this.options.attributeValueProcessor(D,A,w);k[P]=I==null?A:typeof I!=typeof A||I!==A?I:L(A,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(k[P]=!0)}if(!Object.keys(k).length)return;if(this.options.attributesGroupName){var B={};return B[this.options.attributesGroupName]=k,B}return k}}var p=function(m){m=m.replace(/\r\n?/g,`
`);for(var w=new a("!xml"),T=w,g="",x="",k=0;k<m.length;k++)if(m[k]==="<")if(m[k+1]==="/"){var _=C(m,">",k,"Closing Tag is not closed."),D=m.substring(k+2,_).trim();if(this.options.removeNSPrefix){var A=D.indexOf(":");A!==-1&&(D=D.substr(A+1))}this.options.transformTagName&&(D=this.options.transformTagName(D)),T&&(g=this.saveTextToParentTag(g,T,x));var P=x.substring(x.lastIndexOf(".")+1);if(D&&this.options.unpairedTags.indexOf(D)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </"+D+">");var I=0;P&&this.options.unpairedTags.indexOf(P)!==-1?(I=x.lastIndexOf(".",x.lastIndexOf(".")-1),this.tagsNodeStack.pop()):I=x.lastIndexOf("."),x=x.substring(0,I),T=this.tagsNodeStack.pop(),g="",k=_}else if(m[k+1]==="?"){var B=f(m,k,!1,"?>");if(!B)throw new Error("Pi Tag is not closed.");if(g=this.saveTextToParentTag(g,T,x),!(this.options.ignoreDeclaration&&B.tagName==="?xml"||this.options.ignorePiTags)){var H=new a(B.tagName);H.add(this.options.textNodeName,""),B.tagName!==B.tagExp&&B.attrExpPresent&&(H[":@"]=this.buildAttributesMap(B.tagExp,x,B.tagName)),this.addChild(T,H,x)}k=B.closeIndex+1}else if(m.substr(k+1,3)==="!--"){var U=C(m,"-->",k+4,"Comment is not closed.");if(this.options.commentPropName){var F,j=m.substring(k+4,U-2);g=this.saveTextToParentTag(g,T,x),T.add(this.options.commentPropName,[(F={},F[this.options.textNodeName]=j,F)])}k=U}else if(m.substr(k+1,2)==="!D"){var J=u(m,k);this.docTypeEntities=J.entities,k=J.i}else if(m.substr(k+1,2)==="!["){var V=C(m,"]]>",k,"CDATA is not closed.")-2,$=m.substring(k+9,V);g=this.saveTextToParentTag(g,T,x);var z,G=this.parseTextData($,T.tagname,x,!0,!1,!0,!0);G==null&&(G=""),this.options.cdataPropName?T.add(this.options.cdataPropName,[(z={},z[this.options.textNodeName]=$,z)]):T.add(this.options.textNodeName,G),k=V+2}else{var q=f(m,k,this.options.removeNSPrefix),M=q.tagName,Q=q.rawTagName,R=q.tagExp,X=q.attrExpPresent,ee=q.closeIndex;this.options.transformTagName&&(M=this.options.transformTagName(M)),T&&g&&T.tagname!=="!xml"&&(g=this.saveTextToParentTag(g,T,x,!1));var te=T;if(te&&this.options.unpairedTags.indexOf(te.tagname)!==-1&&(T=this.tagsNodeStack.pop(),x=x.substring(0,x.lastIndexOf("."))),M!==w.tagname&&(x+=x?"."+M:M),this.isItStopNode(this.options.stopNodes,x,M)){var W="";if(R.length>0&&R.lastIndexOf("/")===R.length-1)M[M.length-1]==="/"?(M=M.substr(0,M.length-1),x=x.substr(0,x.length-1),R=M):R=R.substr(0,R.length-1),k=q.closeIndex;else if(this.options.unpairedTags.indexOf(M)!==-1)k=q.closeIndex;else{var K=this.readStopNodeData(m,Q,ee+1);if(!K)throw new Error("Unexpected end of "+Q);k=K.i,W=K.tagContent}var Y=new a(M);M!==R&&X&&(Y[":@"]=this.buildAttributesMap(R,x,M)),W&&(W=this.parseTextData(W,M,x,!0,X,!0,!0)),x=x.substr(0,x.lastIndexOf(".")),Y.add(this.options.textNodeName,W),this.addChild(T,Y,x)}else{if(R.length>0&&R.lastIndexOf("/")===R.length-1){M[M.length-1]==="/"?(M=M.substr(0,M.length-1),x=x.substr(0,x.length-1),R=M):R=R.substr(0,R.length-1),this.options.transformTagName&&(M=this.options.transformTagName(M));var oe=new a(M);M!==R&&X&&(oe[":@"]=this.buildAttributesMap(R,x,M)),this.addChild(T,oe,x),x=x.substr(0,x.lastIndexOf("."))}else{var Z=new a(M);this.tagsNodeStack.push(T),M!==R&&X&&(Z[":@"]=this.buildAttributesMap(R,x,M)),this.addChild(T,Z,x),T=Z}g="",k=ee}}else g+=m[k];return w.child};function y(m,w,T){var g=this.options.updateTag(w.tagname,T,w[":@"]);g===!1||(typeof g=="string"&&(w.tagname=g),m.addChild(w))}var b=function(m){if(this.options.processEntities){for(var w in this.docTypeEntities){var T=this.docTypeEntities[w];m=m.replace(T.regx,T.val)}for(var g in this.lastEntities){var x=this.lastEntities[g];m=m.replace(x.regex,x.val)}if(this.options.htmlEntities)for(var k in this.htmlEntities){var _=this.htmlEntities[k];m=m.replace(_.regex,_.val)}m=m.replace(this.ampEntity.regex,this.ampEntity.val)}return m};function N(m,w,T,g){return m&&(g===void 0&&(g=Object.keys(w.child).length===0),(m=this.parseTextData(m,w.tagname,T,!1,!!w[":@"]&&Object.keys(w[":@"]).length!==0,g))!==void 0&&m!==""&&w.add(this.options.textNodeName,m),m=""),m}function O(m,w,T){var g="*."+T;for(var x in m){var k=m[x];if(g===k||w===k)return!0}return!1}function C(m,w,T,g){var x=m.indexOf(w,T);if(x===-1)throw new Error(g);return x+w.length-1}function f(m,w,T,g){g===void 0&&(g=">");var x=function(H,U,F){var j;F===void 0&&(F=">");for(var J="",V=U;V<H.length;V++){var $=H[V];if(j)$===j&&(j="");else if($==='"'||$==="'")j=$;else if($===F[0]){if(!F[1])return{data:J,index:V};if(H[V+1]===F[1])return{data:J,index:V}}else $==="	"&&($=" ");J+=$}}(m,w+1,g);if(x){var k=x.data,_=x.index,D=k.search(/\s/),A=k,P=!0;D!==-1&&(A=k.substring(0,D),k=k.substring(D+1).trimStart());var I=A;if(T){var B=A.indexOf(":");B!==-1&&(P=(A=A.substr(B+1))!==x.data.substr(B+1))}return{tagName:A,tagExp:k,closeIndex:_,attrExpPresent:P,rawTagName:I}}}function E(m,w,T){for(var g=T,x=1;T<m.length;T++)if(m[T]==="<")if(m[T+1]==="/"){var k=C(m,">",T,w+" is not closed");if(m.substring(T+2,k).trim()===w&&--x==0)return{tagContent:m.substring(g,T),i:k};T=k}else if(m[T+1]==="?")T=C(m,"?>",T+1,"StopNode is not closed.");else if(m.substr(T+1,3)==="!--")T=C(m,"-->",T+3,"StopNode is not closed.");else if(m.substr(T+1,2)==="![")T=C(m,"]]>",T,"StopNode is not closed.")-2;else{var _=f(m,T,">");_&&((_&&_.tagName)===w&&_.tagExp[_.tagExp.length-1]!=="/"&&x++,T=_.closeIndex)}}function L(m,w,T){if(w&&typeof m=="string"){var g=m.trim();return g==="true"||g!=="false"&&c(m,T)}return i.isExist(m)?m:""}r.exports=function(m){this.options=m,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:function(w,T){return String.fromCharCode(Number.parseInt(T,10))}},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:function(w,T){return String.fromCharCode(Number.parseInt(T,16))}}},this.addExternalEntities=d,this.parseXml=p,this.parseTextData=h,this.resolveNameSpace=S,this.buildAttributesMap=l,this.isItStopNode=O,this.replaceEntitiesValue=b,this.readStopNodeData=E,this.saveTextToParentTag=N,this.addChild=y}},354:(r,n,s)=>{var i=s(7).buildOptions,a=s(731),u=s(120).prettify,c=s(631),d=function(){function h(v){this.externalEntities={},this.options=i(v)}var S=h.prototype;return S.parse=function(v,l){if(typeof v!="string"){if(!v.toString)throw new Error("XML data is accepted in String or Bytes[] form.");v=v.toString()}if(l){l===!0&&(l={});var p=c.validate(v,l);if(p!==!0)throw Error(p.err.msg+":"+p.err.line+":"+p.err.col)}var y=new a(this.options);y.addExternalEntities(this.externalEntities);var b=y.parseXml(v);return this.options.preserveOrder||b===void 0?b:u(b,this.options)},S.addEntity=function(v,l){if(l.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(v.indexOf("&")!==-1||v.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(l==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[v]=l},h}();r.exports=d},120:(r,n)=>{function s(c,d,h){for(var S,v={},l=0;l<c.length;l++){var p,y=c[l],b=i(y);if(p=h===void 0?b:h+"."+b,b===d.textNodeName)S===void 0?S=y[b]:S+=""+y[b];else{if(b===void 0)continue;if(y[b]){var N=s(y[b],d,p),O=u(N,d);y[":@"]?a(N,y[":@"],p,d):Object.keys(N).length!==1||N[d.textNodeName]===void 0||d.alwaysCreateTextNode?Object.keys(N).length===0&&(d.alwaysCreateTextNode?N[d.textNodeName]="":N=""):N=N[d.textNodeName],v[b]!==void 0&&v.hasOwnProperty(b)?(Array.isArray(v[b])||(v[b]=[v[b]]),v[b].push(N)):d.isArray(b,p,O)?v[b]=[N]:v[b]=N}}}return typeof S=="string"?S.length>0&&(v[d.textNodeName]=S):S!==void 0&&(v[d.textNodeName]=S),v}function i(c){for(var d=Object.keys(c),h=0;h<d.length;h++){var S=d[h];if(S!==":@")return S}}function a(c,d,h,S){if(d)for(var v=Object.keys(d),l=v.length,p=0;p<l;p++){var y=v[p];S.isArray(y,h+"."+y,!0,!0)?c[y]=[d[y]]:c[y]=d[y]}}function u(c,d){var h=d.textNodeName,S=Object.keys(c).length;return S===0||!(S!==1||!c[h]&&typeof c[h]!="boolean"&&c[h]!==0)}n.prettify=function(c,d){return s(c,d)}},501:r=>{var n=function(){function s(a){this.tagname=a,this.child=[],this[":@"]={}}var i=s.prototype;return i.add=function(a,u){var c;a==="__proto__"&&(a="#__proto__"),this.child.push(((c={})[a]=u,c))},i.addChild=function(a){var u,c;a.tagname==="__proto__"&&(a.tagname="#__proto__"),a[":@"]&&Object.keys(a[":@"]).length>0?this.child.push(((u={})[a.tagname]=a.child,u[":@"]=a[":@"],u)):this.child.push(((c={})[a.tagname]=a.child,c))},s}();r.exports=n}},t={},o=function r(n){var s=t[n];if(s!==void 0)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(354);XMLParser=o})();const XMLParser$1=XMLParser,DOM_ELEMENT={toasterWrapper:document.querySelector("#toaster"),toasterMessage:document.querySelector("#toasterMessage"),toasterStatusIcon:document.querySelector("#icon"),toastWithCloseButtonWrapper:document.querySelector("#closeButtonToast"),toastWithCloseButtonMessage:document.querySelector("#closeButtonToastMessage"),toastWithCloseButtonStatusIcon:document.querySelector("#closeButtonToastStatusIcon"),saveScriptButton:document.querySelector("#saveScript"),saveScriptButtonText:document.querySelector("#saveScriptButtonText"),saveScriptLoader:document.querySelector("#saveScriptLoader"),saveAsDraft:document.querySelector("#saveAsDraft"),saveAsDraftButtonText:document.querySelector("#saveAsDraftButtonText"),saveAsDraftLoader:document.querySelector("#saveAsDraftLoader"),generateFHIRJson:document.querySelector("#generateFHIRJson"),preloaderMain:document.querySelector("#preloaderMain"),preloaderBlockly:document.querySelector("#preloaderBlockly"),leftPanelLoader:document.querySelector("#leftPanelLoader"),templateSelector:document.querySelector("#selectedTemplateName"),versionListSelector:document.querySelector("#versionList"),nameField:document.querySelector("#templatename"),templateDescription:document.querySelector("#templateDescription"),invalidMessageText:document.querySelector("#invalidMessageText"),switchFromSelector:document.querySelector("#switchFrom"),switchFromTitle:document.querySelector("#switchFromTitle"),switchToSelector:document.querySelector("#switchTo"),switchToTitle:document.querySelector("#switchToTitle"),deleteTemplateButton:document.querySelector("#deleteTemplate"),panelToggleButton:document.querySelector("#panelToggleButton"),panelCloseButton:document.querySelector("#panelCloseButton"),rightPanel:document.querySelector("#rightPanel"),sourceListSelector:document.querySelector("#sourceListSelector"),targetListSelector:document.querySelector("#targetListSelector"),listMappingAddButton:document.querySelector("#listMappingAddButton"),sourceListSelectorTitle:document.querySelector("#sourceListSelectorTitle"),targetListSelectorTitle:document.querySelector("#targetListSelectorTitle"),sourceListSubNode:document.querySelector("#sourceListSubNode"),targetListSubNode:document.querySelector("#targetListSubNode")},SOURCE_LIST_MAPPING=[{value:"",text:"Select an Item",node:""},{value:"administrativeGenderCode",text:"AdministrativeGenderCode"}],TARGET_LIST_MAPPING=[{value:"",text:"Select an Item",node:""},{value:"gender",text:"Gender"}],CCDA_GENDERS_LIST=[{code:"M",value:"M",description:"This indicate to male in CCDA"},{code:"F",value:"F",description:"This indicate to female in CCDA"},{code:"UNK",value:"UNK",description:"This indicate to unknown in CCDA"},{code:"UNK1",value:"UNK1",description:"This indicate to unknown one in CCDA"},{code:"UNK2",value:"UNK2",description:"This indicate to unknown two in CCDA"}],FHIR_GENDERS_LIST=[{code:"M",value:"Male",description:"This indicate to male in FHIR"},{code:"F",value:"Female",description:"This indicate to female in FHIR"},{code:"UN",value:"Undifferentiated",description:"This indicate to undifferentiated in FHIR"},{code:"U",value:"Unknown",description:"This indicate to unknown in FHIR"}],showToast=(e,t,o)=>{DOM_ELEMENT.toasterMessage.textContent=e;let r=o||2e3;t==="success"?(DOM_ELEMENT.toasterWrapper.className="fixed top-5 left-1/2 transform -translate-x-1/2 p-4 rounded shadow-md toaster w-96 flex items-center space-x-3 bg-white border border-green-500",DOM_ELEMENT.toasterStatusIcon.innerHTML="&#10004;",DOM_ELEMENT.toasterStatusIcon.className="text-green-500"):(DOM_ELEMENT.toasterWrapper.className="fixed top-5 left-1/2 transform -translate-x-1/2 p-4 rounded shadow-md toaster w-96 flex items-center space-x-3 bg-white border border-red-500",DOM_ELEMENT.toasterStatusIcon.innerHTML="&#10060;",DOM_ELEMENT.toasterStatusIcon.className="text-red-500"),DOM_ELEMENT.toasterWrapper.classList.add("show"),setTimeout(()=>{DOM_ELEMENT.toasterWrapper.classList.remove("show")},r)},displayToastwithCloseButton=(e,t)=>{DOM_ELEMENT.toastWithCloseButtonMessage.textContent=e,DOM_ELEMENT.toastWithCloseButtonWrapper.className="fixed top-5 left-1/2 transform -translate-x-1/2 pl-4 pb-4 pr-8 pt-6 rounded shadow-md toaster w-96 flex items-center space-x-3 bg-white border border-red-500",DOM_ELEMENT.toastWithCloseButtonStatusIcon.innerHTML="&#10060;",DOM_ELEMENT.toastWithCloseButtonStatusIcon.className="text-red-500";const o=document.createElement("button");o.innerHTML="&times;",o.className="absolute top-0 right-0 p-2 text-gray-400 hover:text-gray-600 focus:outline-none text-2xl w-10 h-10 flex items-center justify-center";const r=DOM_ELEMENT.toastWithCloseButtonWrapper.querySelector("button");r&&r.remove(),o.addEventListener("click",()=>{DOM_ELEMENT.toastWithCloseButtonWrapper.classList.remove("show")}),DOM_ELEMENT.toastWithCloseButtonWrapper.appendChild(o),DOM_ELEMENT.toastWithCloseButtonWrapper.classList.add("show")},showNameValidation=e=>{e===!0?(DOM_ELEMENT.nameField.classList.add("border-red-500","ring-red-500"),DOM_ELEMENT.invalidMessageText.classList.remove("hidden")):(DOM_ELEMENT.nameField.classList.remove("border-red-500","ring-red-500"),DOM_ELEMENT.invalidMessageText.classList.add("hidden"))},showBlocklyWorkspaceErrorMsg=e=>{const t=document.getElementById("blocklyDiv");if(t){document.getElementById("blocklyWorkspaceErrorMsg")?.remove();const r=document.createElement("div");r.id="blocklyWorkspaceErrorMsg",r.className="absolute inset-0 flex items-center justify-center text-gray-600 text-lg font-medium z-40 bg-white bg-opacity-90",r.textContent=e,t.parentElement?.appendChild(r)}},hideBlocklyWorkspaceErrorMsg=()=>{document.getElementById("blocklyWorkspaceErrorMsg")?.remove()},showBlocklyWorkspaceLoader=()=>{DOM_ELEMENT.preloaderBlockly.style.display="flex"},hideBlocklyWorkspaceLoader=()=>{DOM_ELEMENT.preloaderBlockly.style.display="none"},showLeftEditorLoader=()=>{const e=document.getElementById("leftJsonEditor");if(e){const t=e.querySelector(".jsoneditor-tree-inner");if(t){const o=document.createElement("div");o.id="jsonLoader",o.className="absolute inset-0 flex justify-center items-center bg-white bg-opacity-50",o.innerHTML=`
            <div class="w-6 h-6 border-4 border-gray-300 border-t-blue-600 rounded-full animate-spin"></div>
            `,t.appendChild(o)}}},hideLeftEditorLoader=()=>{document.getElementById("jsonLoader")?.remove()},showLeftEditorErrorMessage=(e,t=void 0)=>{const o=document.getElementById("leftJsonEditor"),r=document.createElement("div");r.id="leftEditorErrorMessage",r.className="absolute inset-0 flex justify-center items-center bg-white bg-opacity-50 text-center text-red-600 font-medium",r.textContent=t?`${e}: ${t}`:e,o&&o.querySelector(".jsoneditor-tree-inner")?.appendChild(r)};let currentPath=null;const leftEditor=new JSONEditor(document.getElementById("leftJsonEditor"),{mode:"tree",onEditable:()=>!1,onCreateMenu:(e,t)=>(e.push({text:"Workspace",click:()=>addToWorkspace(t,!1)}),e)});window.getSourceData=async()=>{showLeftEditorLoader();let e=blocklyConfigId;console.log("blocklyConfigId:",blocklyConfigId),console.log("templateId:",templateId),(blocklyConfigId===null||blocklyConfigId==="null")&&(e=templateId),console.log("blocklyId param passing to GetSourceFile:",e);try{const o=(await apiClient.get(`api/Configuration/GetSourceFile?blocklyId=${e}`)).data;try{const r=await fetch(o);if(!r.ok||r.status===400){hideLeftEditorLoader(),showLeftEditorErrorMessage("Error loading source file",r.statusText),showToast("Error loading source file","error");return}const n=await r.text(),s=new XMLParser$1({ignoreDeclaration:!0,ignoreAttributes:!1,attributeNamePrefix:"",textNodeName:"_text"});window.parsedXml={ClinicalDocument:s.parse(n).ClinicalDocument},window.convertFrom==="Default - FHIR"&&(window.parsedXml={}),leftEditor.set(window.parsedXml),hideLeftEditorLoader(),DOM_ELEMENT.generateFHIRJson.disabled=!1}catch(r){showToast("Error during fetching the XML source file","error"),hideLeftEditorLoader(),showLeftEditorErrorMessage("Error during fetching the XML source file"),console.error("Error during fetching the XML:",r)}}catch(t){showToast("Error during API request","error"),hideLeftEditorLoader(),showLeftEditorErrorMessage("Source file not found. It may have been moved or deleted."),console.error("Error during API request:",t)}};window.getSourceData();window.rightEditor=new JSONEditor(document.getElementById("rightJsonEditor"),{mode:"tree",onCreateMenu:(e,t)=>(e.push({text:"Add to Workspace",click:()=>addToWorkspace(t,!0,window.oldKey)}),e),onEditable:e=>({field:!0,value:!1}),onValidate:e=>[],onEvent:(e,t)=>{t.type==="click"&&(currentPath=e.path)},onChange:()=>{currentPath&&(window.oldKey=currentPath[currentPath.length-1],currentPath=null)},enableSort:!1,enableTransform:!1});function addToWorkspace(e,t=!1,o){const r=e.path.join("."),n=t?"target_json_path":"source_json_path",s=Blockly.getMainWorkspace(),i=s.newBlock(n);let a=t&&o?`${r}|${o}`:r;i.setFieldValue(a,"PATH"),i.initSvg(),i.render();const u=s.getMetrics(),c=s.getAllBlocks();let d=u.viewWidth/2,h=u.viewHeight/2;if(c.length>0){const S=c[c.length-1];t&&S.type==="source_json_path"?(i.getInput("SOURCE").connection.connect(S.outputConnection),d=S.getRelativeToSurfaceXY().x+S.width+10,h=S.getRelativeToSurfaceXY().y):(d=S.getRelativeToSurfaceXY().x,h=S.getRelativeToSurfaceXY().y+S.height+10)}i.moveBy(d,h)}window.location.search.includes("blocklyId")||window.location.search.includes("templateid");let sourceXPathWithValue="",targetValue="";const canvas=document.getElementById("connectionCanvas"),ctx=canvas.getContext("2d");let sourceItems=[],targetItems=[],connections=[],selectedSource=null;const mappedSources=new Set;function createListMappingBlock(){let e=7e3;const t=1;for(let o of connections){const r=window.wp.newBlock("list_mapping_source");r.setFieldValue(o.sourceXpath,"PATH");const n=window.wp.newBlock("list_mapping_target");n.setFieldValue(o.targetValue,"PATH"),r.initSvg(),r.render(),n.initSvg(),n.render(),r.moveBy(10,e);const s=r.getHeightWidth().height;n.moveBy(10,e+s+t),r.outputConnection&&n.getInput("SOURCE").connection?r.outputConnection.connect(n.getInput("SOURCE").connection):console.log("The blocks do not have compatible connections to connect."),e+=s+n.getHeightWidth().height+t}showToast("Blocks added successfully in workspace.","success")}function findXPath(e,t,o=""){if(e&&typeof e=="object"){if(t in e)return`${o}/${t}`;for(const r in e){const n=findXPath(e[r],t,`${o}/${r}`);if(n)return n}}return null}function resizeCanvas(){canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,drawConnections()}resizeCanvas();window.addEventListener("resize",resizeCanvas);function handleSourceClick(e,t){sourceItems=document.querySelectorAll("#sourceListSubNode li"),sourceItems.forEach(r=>r.classList.remove("selected")),selectedSource=e.currentTarget,selectedSource.classList.add("selected");const o=e.currentTarget.getAttribute("data-value");sourceXPathWithValue=`${t}.code:${o}`}function handleTargetClick(e){if(!selectedSource){showToast("Please select a source item first.","fail");return}if(mappedSources.has(selectedSource.id)){showToast("This source item is already mapped to a target.","fail");return}if(sourceItems.length<=targetItems.length){showToast("Mapping is not required.","fail");return}if(selectedSource.getAttribute("data-custom-index")===e.currentTarget.getAttribute("data-custom-index")){showToast("Direct mapping is already defined in Defaul mapping.","fail");return}createConnection(selectedSource,e.currentTarget)}function createConnection(e,t){const o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),n=canvas.getBoundingClientRect(),s=o.right-n.left,i=o.top+o.height/2-n.top,a=r.left-n.left,u=r.top+r.height/2-n.top,c={source:e.id,target:t.id,startX:s,startY:i,endX:a,endY:u};c.removeButton=createRemoveButton(c),connections.push(c),mappedSources.add(e.id),drawConnections(),selectedSource.classList.remove("selected"),selectedSource=null}function createRemoveButton(e){const t=document.createElement("button");t.classList.add("remove-button"),t.textContent="X";const o=(e.startX+e.endX)/2,r=(e.startY+e.endY)/2;return t.style.left=`${o-10}px`,t.style.top=`${r-10}px`,t.addEventListener("click",function(n){n.stopPropagation(),removeConnection(e)}),DOM_ELEMENT.rightPanel.appendChild(t),t}function removeConnection(e){const t=connections.indexOf(e);t>-1&&connections.splice(t,1),e.removeButton.remove(),mappedSources.delete(e.source),drawConnections()}function drawConnections(){ctx.clearRect(0,0,canvas.width,canvas.height),connections.forEach(e=>{ctx.beginPath(),ctx.moveTo(e.startX,e.startY),ctx.lineTo(e.endX,e.endY),ctx.strokeStyle="#5c96bc",ctx.lineWidth=2,ctx.stroke(),drawArrowhead(e.endX,e.endY,Math.atan2(e.endY-e.startY,e.endX-e.startX));const t=(e.startX+e.endX)/2,o=(e.startY+e.endY)/2;e.removeButton.style.left=`${t-10}px`,e.removeButton.style.top=`${o-10}px`})}function drawArrowhead(e,t,o){ctx.beginPath(),ctx.moveTo(e,t),ctx.lineTo(e-10*Math.cos(o-Math.PI/6),t-10*Math.sin(o-Math.PI/6)),ctx.moveTo(e,t),ctx.lineTo(e-10*Math.cos(o+Math.PI/6),t-10*Math.sin(o+Math.PI/6)),ctx.stroke()}function createTooltipForListItems(e,t){const o=document.createElement("span");o.innerHTML="",o.classList.add("info-icon"),e.appendChild(o);const r=document.createElement("span");r.classList.add("tooltip"),r.textContent=t.description,e.appendChild(r)}DOM_ELEMENT.panelToggleButton.addEventListener("click",()=>{DOM_ELEMENT.rightPanel.classList.toggle("opened")});DOM_ELEMENT.panelCloseButton.addEventListener("click",()=>{DOM_ELEMENT.rightPanel.classList.remove("opened")});SOURCE_LIST_MAPPING.forEach(e=>{const t=document.createElement("option");t.value=e.value,t.text=e.text,DOM_ELEMENT.sourceListSelector.appendChild(t)});TARGET_LIST_MAPPING.forEach(e=>{const t=document.createElement("option");t.value=e.value,t.text=e.text,DOM_ELEMENT.targetListSelector.appendChild(t)});DOM_ELEMENT.listMappingAddButton.addEventListener("click",()=>{connections.length>0&&createListMappingBlock()});DOM_ELEMENT.sourceListSelector.addEventListener("change",e=>{const t=e.currentTarget.value,o=DOM_ELEMENT.sourceListSubNode;if(t==="administrativeGenderCode"){const n=findXPath(window.parsedXml,"administrativeGenderCode").slice(1).replaceAll("/",".");o.innerHTML="",CCDA_GENDERS_LIST.forEach((s,i)=>{const a=document.createElement("li");a.id=`sourceList-${s?.code}`,a.classList.add("border","px-2","py-1","rounded","mt-2","border-l-[3px]","border-green-700","bg-green-100"),a.textContent=`${s.value}`,a.setAttribute("data-value",s.value),a.setAttribute("data-custom-index",i),createTooltipForListItems(a,s),o.appendChild(a),a.addEventListener("click",u=>{handleSourceClick(u,n)})})}else o.innerHTML=""});DOM_ELEMENT.targetListSelector.addEventListener("change",e=>{const t=e.currentTarget.value,o=DOM_ELEMENT.targetListSubNode;t==="gender"?(o.innerHTML="",FHIR_GENDERS_LIST.forEach((r,n)=>{const s=document.createElement("li");s.id=`targetList-${r?.code}`,s.classList.add("border","px-2","py-1","rounded","mt-2","border-l-[3px]","border-blue-700","bg-blue-100"),s.textContent=`${r.value}`,s.setAttribute("data-value",r.value),s.setAttribute("data-custom-index",n),o.appendChild(s),createTooltipForListItems(s,r),s.addEventListener("click",i=>{targetItems=document.querySelectorAll("#targetListSubNode li"),handleTargetClick(i),targetValue=i.target.getAttribute("data-value"),connections[connections.length-1].sourceXpath=sourceXPathWithValue,connections[connections.length-1].targetValue=targetValue})})):o.innerHTML=""});const toolbox=`
<xml id="toolbox" style="display: none">   
 <category id="catBasic" name="Basic" colour="120">
    <block type="bi_console_log"></block>
    <block type="set_right_editor"></block>
 </category>
 <category id="catLogic" name="Logic" colour="140">
      <block type="controls_if"></block>
      <block type="bi_logic_compare"></block>
      <block type="bi_logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
      <block type="logic_null"></block>
      <block type="logic_ternary"></block>
    </category>
    <category id="catLoops" name="Loops" colour="160">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
      <block type="bi_for"></block>
      <block type="bi_for_in"></block>
      <block type="bi_switch"></block>
      <block type="bi_case"></block>
      <block type="bi_continue"></block>
      <block type="bi_break"></block>
      <block type="controls_for">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
        <value name="BY">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="controls_forEach"></block>
      <block type="controls_forEachKey"></block>
      <block type="controls_flow_statements"></block>
      <block type="bi_throw"></block>
      <block type="bi_yield"></block>
      <block type="bi_yield_return"></block>      
    </category>
    <category name="Math" colour="180">
       <block type="math_number"></block>
    </category>
     <category name="Text" colour="200">
        <block type="text"></block>
     </category>
     <category id="catLists" name="Lists" colour="220">
     
      <block type="lists_create_with"></block>
      <block type="bi_index"></block>
      <block type="lists_repeat">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_length"></block>
  
      </category>
     <category name="Maps" colour="240">
        <block type="maps_create_with"></block>
        <block type="maps_length"></block>
        <block type="maps_isempty"></block>
        <block type="maps_create"></block>
        <block type="bi_maps_set"></block>
        <block type="bi_maps_get"></block>
        <block type="maps_getIndex"></block>
        <block type="maps_setIndex"></block>
        <block type="maps_keys"></block>
    </category>
    <category id="catVariables" name="Variables" colour="260">
      <block type="bi_var"></block>
      <block type="bi_var_name"></block>      
      <block type="bi_assignment"></block>      
      <block type="bi_assignment_return"></block>      
      <block type="bi_field"></block>
      <block type="bi_field_return"></block>
    </category>
    <category id="catFunctions" name="Functions" colour="280">
      <block type="bi_function"></block>
      <block type="bi_function_return"></block>

      <block type="bi_call_editable"></block>      
      <block type="bi_call_editable_return"></block>     <block type="bi_direct_call_editable"></block>      
      <block type="bi_direct_call_editable_return"></block>      
      <block type="bi_return"></block>
      <block type="bi_spread"></block>
    </category>
    </xml>`,validationErrorsBottomSheet=e=>{const t=e.length,o=document.getElementById("errorPopup"),r=document.getElementById("popupBody"),n=document.getElementById("errorCountHeader"),s=document.getElementById("toggleBtn"),i=document.getElementById("closeBtn"),a=`<svg xmlns="http://www.w3.org/2000/svg" class="size-5 ml-1 stroke-[1.5]" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
    </svg>
    `,u=`<svg xmlns="http://www.w3.org/2000/svg"  class="size-5 ml-1 stroke-[1.5]" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 15.75 7.5-7.5 7.5 7.5" />
    </svg>
    `,c=`
    <svg xmlns="http://www.w3.org/2000/svg" class="size-5 ml-1 stroke-[1.5] text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
    </svg>
    `;s.innerHTML=u,i.innerHTML=c,n.innerText="",o.classList.remove("hidden"),o.classList.add("flex"),o.classList.remove("w-[250px]","h-auto"),o.classList.add("w-[99%]","h-[50vh]"),n.innerText=`  (${t} errors)`,s.innerHTML=a,s.title="Minimize",r.innerHTML=e.map(d=>`
        <div class="flex items-start space-x-2 py-2">
          <div class="mt-1 text-red-500"></div>
          <pre class="text-sm text-red-700 bg-red-50 p-2 rounded whitespace-pre-wrap leading-snug">
  {
    diagnostics: ${JSON.stringify(d.diagnostics,null,2)},
    location: ${JSON.stringify(d.location,null,2)}
  }
          </pre>
        </div>`).join(""),s.onclick=()=>{o.classList.contains("w-[99%]")?(r.classList.add("hidden"),o.classList.remove("w-[99%]","h-[50vh]"),o.classList.add("w-[250px]","h-auto"),r.innerHTML="",s.innerHTML=u,s.title="Maximize",n.innerText=""):(r.classList.remove("hidden"),o.classList.remove("w-[250px]","h-auto"),o.classList.add("w-[99%]","h-[50vh]"),r.innerHTML=e.map(h=>`
                <div class="flex items-start space-x-2 py-2">
                  <div class="mt-1 text-red-500"></div>
                  <pre class="text-sm text-red-700 bg-red-50 p-2 rounded whitespace-pre-wrap leading-snug">
          {
            diagnostics: ${JSON.stringify(h.diagnostics,null,2)},
            location: ${JSON.stringify(h.location,null,2)}
          }
                  </pre>
                </div>`).join(""),s.innerHTML=a,s.title="Minimize",n.innerText=`  (${t} errors)`)},i.onclick=()=>{o.classList.remove("flex"),o.classList.add("hidden")}};Blockly.Blocks.source_json_path={init:function(){this.appendDummyInput().appendField(new Blockly.FieldTextInput(""),"PATH"),this.setOutput(!0,"String"),this.setColour(120),this.setTooltip("Represents a Source JSON path")}};Blockly.Blocks.target_json_path={init:function(){this.appendValueInput("SOURCE").setCheck("String").appendField("One to one mapping:"),this.appendDummyInput().appendField(new Blockly.FieldTextInput(""),"PATH"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(130),this.setTooltip("Represents a Target JSON path")}};Blockly.Blocks.list_mapping_source={init:function(){this.appendDummyInput().appendField(new Blockly.FieldTextInput(""),"PATH"),this.setOutput(!0,"String"),this.setColour(280),this.setTooltip("Represents a Source List Mapping")}};Blockly.Blocks.list_mapping_target={init:function(){this.appendValueInput("SOURCE").setCheck("String").appendField("List mapping:"),this.appendDummyInput().appendField(new Blockly.FieldTextInput(""),"PATH"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(270),this.setTooltip("Represents a Target List Mapping")}};Blockly.JavaScript.bi_console_log=function(e){var t=Blockly.JavaScript.valueToCode(e,"LOG_VALUE",Blockly.JavaScript.ORDER_NONE),o="console.log("+t+`);
`;return o};Blockly.JavaScript.source_json_path=function(e){var t=e.getFieldValue("PATH");return[JSON.stringify(t),Blockly.JavaScript.ORDER_ATOMIC]};Blockly.JavaScript.target_json_path=function(e){var t=Blockly.JavaScript.valueToCode(e,"SOURCE",Blockly.JavaScript.ORDER_ATOMIC)||'""',o=e.getFieldValue("PATH");return`mapJsonPath(${t}, "${o}");
`};Blockly.JavaScript.list_mapping_source=function(e){var t=e.getFieldValue("PATH");return[JSON.stringify(t),Blockly.JavaScript.ORDER_ATOMIC]};Blockly.JavaScript.list_mapping_target=function(e){var t=Blockly.JavaScript.valueToCode(e,"SOURCE",Blockly.JavaScript.ORDER_ATOMIC)||'""',o=e.getFieldValue("PATH");return`mapListing(${t}, "${o}");
`};function updateNestedKey(e,t,o){if(!(typeof e!="object"||e===null))for(const r in e)r===t?e[r]=o:typeof e[r]=="object"&&updateNestedKey(e[r],t,o)}function mapListing(e,t){const o=e.split(":")[0],r=e.split(":")[1];o.split(".").reduce((i,a)=>i?i[a]:void 0,window.parsedXml)===r&&updateNestedKey(window.mappedData,"gender",t)}function getNestedValue(e,t){return t.split(".").reduce((o,r)=>o&&o[r],e)}function mapJsonPath(e,t){const o=getNestedValue(window.parsedXml,e);if(o!==void 0){const r=t.split("|")[1],n=e.split("."),s=t.split("|")[0].split("."),i=n[n.length-1],a=s[s.length-1];let u=window.mappedData;for(let c=0;c<s.length-1;c++)u[s[c]]||(u[s[c]]={}),u=u[s[c]];window.changedNodeIndex=s[1],Array.isArray(u)?u[window.changedNodeIndex]&&typeof u[window.changedNodeIndex]=="object"?i in u[window.changedNodeIndex]?(u[window.changedNodeIndex][a]=u[window.changedNodeIndex][i],i!==a&&delete u[window.changedNodeIndex][i]):u[window.changedNodeIndex][a]=o:u[window.changedNodeIndex]={[a]:o}:typeof u=="object"&&(i in u?(u[a]=u[i],i!==a&&delete u[i]):(u[a]=o,s.pop(),delete u[r]))}}function generateCode(){let e=Blockly.getMainWorkspace();return Blockly.JavaScript.workspaceToCode(e)}function enableSaveScriptButton(e,t){const o=Number(DOM_ELEMENT.versionListSelector.value),r=e===!1;console.log("isPublished:",e),console.log("isDraft:",r),console.log("versionId:",o),console.log("publishedVersionListItem:",t),console.log("publishedVersionListItem.id:",t.id),(o==t||o===0)&&r?(DOM_ELEMENT.saveScriptButton.disabled=!1,console.log("DOM_ELEMENT.saveScriptButton.disabled = false")):(DOM_ELEMENT.saveScriptButton.disabled=!0,console.log("DOM_ELEMENT.saveScriptButton.disabled = true"))}const initiateFHIRUpload=async(e,t)=>{const o="data.json",i=t.size>524288e3?52428800:10485760,a=Math.ceil(t.size/i);try{const u=await apiClient.post("/api/UploadData/GeneratePreSignedUrlsforFHIR",{fileName:o,blocklyId:e,totalParts:a},{headers:{"Content-Type":"application/json"}}),{key:c,uploadId:d,presignedUrls:h}=u.data;console.log("presignedResponse.data ",u.data);const S=[];for(let l=0;l<a;l++){const p=l*i,y=Math.min(p+i,t.size),b=t.slice(p,y),O=(await fetch(h[l],{method:"PUT",body:b,headers:{"Content-Type":"application/json"}})).headers.get("ETag")?.replaceAll('"',"");O&&S.push({partNumber:l+1,eTag:O})}const v=await apiClient.post("/api/UploadData/CompleteMultipartUploadFHIR",{key:c,uploadId:d,parts:S},{headers:{"Content-Type":"application/json"}});return console.log("completeResponse:",v),v.data===c?(console.log("Upload successful"),v.data):(console.error("Error completing upload"),!1)}catch(u){return console.error("Multipart upload error:",u),!1}};async function validateFHIRJson(e){const t=window.mappedData;if(console.log("jsonData: ",t),!t)return showToast("No FHIR JSON found","error"),console.log("No FHIR JSON found"),!1;window.rightEditor?.set?.(t);const o=new Blob([JSON.stringify(t)],{type:"application/json"}),r=await initiateFHIRUpload(e,o);if(console.log("key: ",r),r)showToast("FHIR multipart upload is successful","success"),console.log("FHIR multipart upload is successful");else return showToast("FHIR multipart upload unsuccessful","error"),console.log("Multipart unsuccessful"),!1;try{DOM_ELEMENT.generateFHIRJson.innerText="Validating...";const n=await apiClient.post(`/api/HAPI/GetValidate?key=${encodeURIComponent(r)}`);if(!n.status===200)throw new Error("Network response for GetValidate API was not ok");const s=await n.data,i=await apiClient.get(`/api/HAPI/GetValidateResponse?sqsId=${encodeURIComponent(s)}`);if(!i.status===200)throw new Error("Network response for GetValidateResponse API was not ok");const a=await i.data,u=a.issue?.some(c=>["error","fatal"].includes(c.severity));if(console.log("window.mappedData:",window.mappedData),console.log("Validate -  response.data: ",n.data),console.log("GetValidateResponse - response.data: ",i),u){const c=a.issue?.filter(h=>h.severity==="error"||h.severity==="fatal"),d=c.map(h=>({diagnostics:h.diagnostics,location:h.location}));return validationErrorsBottomSheet(c),console.log("All resulting validation errors: ",d),DOM_ELEMENT.generateFHIRJson.innerText="Preview And Validate",DOM_ELEMENT.generateFHIRJson.disabled=!1,!1}else return DOM_ELEMENT.generateFHIRJson.innerText="Preview And Validate",DOM_ELEMENT.generateFHIRJson.disabled=!1,showToast("FHIR JSON is valid","success"),console.log("FHIR JSON is valid"),!0}catch(n){return displayToastwithCloseButton(`Validation error: ${n.message}`),console.log(`Validation error: ${n}`),DOM_ELEMENT.generateFHIRJson.innerText="Preview And Validate",DOM_ELEMENT.generateFHIRJson.disabled=!1,!1}}async function executeCode(isPublished,publishedVersionListItem,blocklyIdForMultipart){DOM_ELEMENT.generateFHIRJson.disabled=!0;const code=generateCode(),getNestedValueFunc=getNestedValue.toString(),mapJsonPathFunc=mapJsonPath.toString(),mapListingFunc=mapListing.toString(),updateNestedKeyFunc=updateNestedKey.toString();console.log("Generated code:",updateNestedKeyFunc+getNestedValueFunc+mapJsonPathFunc+mapListingFunc+code),window.generatedScript=updateNestedKeyFunc+getNestedValueFunc+mapJsonPathFunc+mapListingFunc+code;try{eval(window.generatedScript),showToast("Script Generated Successfully","success");const isValid=await validateFHIRJson(blocklyIdForMultipart);isValid&&enableSaveScriptButton(isPublished,publishedVersionListItem)}catch(e){console.error("Error executing code:",e),showToast("Script Failed to Generate.","fail"),DOM_ELEMENT.generateFHIRJson.disabled=!1}}let Blockly$1=window.Blockly;window.convertFrom="";window.convertTo="";let templateListData,selectedTemplateId,selectedOption,numberOfVersions,isPublished,publishedVersionListItem={},blocklyIdForMultipart,blocklyIdFromMainApp=blocklyConfigId,isGlobalTemplate,isDefaultTemplate;(blocklyConfigId===null||blocklyConfigId==="null")&&(blocklyIdFromMainApp=templateId);const getSelectedTemplateOption=()=>{const e=DOM_ELEMENT.templateSelector;return console.log("templateSelector:",e),selectedTemplateId=e.value||templateId,console.log("templateSelector.value:",e.value),console.log("templateId:",templateId),console.log("selectedTemplateId:",selectedTemplateId),selectedTemplateId?(e.value=String(selectedTemplateId),templateListData.data.find(o=>String(o.templateid)===String(selectedTemplateId))):(console.warn("Template id is not available in templateListDropdownChangeHandler"),!1)};document.body.addEventListener("change",e=>{if(e.target===DOM_ELEMENT.switchFromSelector)window.convertFrom=e.target.value,DOM_ELEMENT.switchFromTitle.textContent=window.convertFrom,DOM_ELEMENT.sourceListSelectorTitle.textContent=window.convertFrom,window.getSourceData();else if(e.target===DOM_ELEMENT.switchToSelector)window.convertTo=e.target.value,DOM_ELEMENT.switchToTitle.textContent=window.convertTo,DOM_ELEMENT.targetListSelectorTitle.textContent=window.convertTo;else if(e.target===DOM_ELEMENT.versionListSelector)versionListElementChangeHandler(e.target.value);else if(e.target===DOM_ELEMENT.templateSelector){let t=e.target.value;loadSavedBlockTemplate(t),templateListDropdownChangeHandler()}});document.body.addEventListener("click",e=>{const{target:t}=e;if(t.closest("#generateFHIRJson"))executeCode(isPublished,publishedVersionListItem,blocklyIdForMultipart);else if(t.closest("#saveScript")){const o=selectedOption.templateid;if((isGlobalTemplate||isDefaultTemplate)&&userRole!=="3"){showToast("Please use a different Template name to save script and publish","error");return}saveScriptAndPublish(o)}else if(t.closest("#deleteTemplate")){const o=selectedOption.templateid;if(isGlobalTemplate&&userRole!=="3"||isDefaultTemplate){showToast("Cannot delete Global/Default template","error",3e3);return}deleteBlocklyTemplate(o)}else if(t.closest("#saveAsDraft")){const o=selectedOption.templateid,r=selectedOption.templateName.trim(),n=DOM_ELEMENT.nameField.value.trim();if(n.toLowerCase()===r.toLowerCase()){if(isGlobalTemplate&&userRole!=="3"){showToast("Please use a different Template name to save as draft","error");return}else if(isGlobalTemplate&&userRole==="3"&&n.toLowerCase()==="default_template"){showToast("Temporarily, 'Default_Template' cannot be saved as a draft. Please use another template name to continue.","error",3e3);return}saveOrUpdateWorkspace(n,"update",o)}else saveOrUpdateWorkspace(n,"new",void 0)}});let workspace=Blockly$1.inject("blocklyDiv",{toolbox,zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.2,scaleSpeed:1.2},trashcan:!1});window.wp=workspace;const saveScriptLoader=DOM_ELEMENT.saveScriptLoader,saveScriptButtonText=DOM_ELEMENT.saveScriptButtonText,saveAsDraftLoader=DOM_ELEMENT.saveAsDraftLoader,saveAsDraftButtonText=DOM_ELEMENT.saveAsDraftButtonText;function showScriptButtonLoader(){saveScriptLoader.classList.remove("hidden"),saveScriptButtonText.classList.add("hidden")}function hideScriptButtonLoader(){saveScriptLoader.classList.add("hidden"),saveScriptButtonText.classList.remove("hidden")}function showSaveAsDraftButtonLoader(){saveAsDraftLoader.classList.remove("hidden"),saveAsDraftButtonText.classList.add("hidden")}function hideSaveAsDraftButtonLoader(){saveAsDraftLoader.classList.add("hidden"),saveAsDraftButtonText.classList.remove("hidden")}function disableSaveScriptButton(){DOM_ELEMENT.saveScriptButton.disabled=!0}function resetRightEditor(){window.rightEditor.set({})}function updateDeleteButtonText(){isPublished!==!1?DOM_ELEMENT.deleteTemplateButton.textContent="Delete Template":DOM_ELEMENT.deleteTemplateButton.textContent="Discard Draft"}function convertUTCToLocal(e){const[t,o]=e.split("_"),r=new Date(o+" UTC"),s=new Date(r).toLocaleString();return`${t}_${s}`}DOM_ELEMENT.preloaderMain.style.display="none";console.log("%c-----> The Beginning <-----","color: #34eb34;");await loadTemplateList();loadSavedBlockTemplate(templateId);templateListDropdownChangeHandler();getStandardsWithVersions();isPublished!==!1?DOM_ELEMENT.deleteTemplateButton.textContent="Delete Template":DOM_ELEMENT.deleteTemplateButton.textContent="Discard Draft";async function loadBlocklyMapping(e,t,o){console.log("%c-----> ENTERED:  loadBlocklyMapping() <-----","color: #34eb34;");let r="";blocklyIdForMultipart=e,hideBlocklyWorkspaceErrorMsg(),showBlocklyWorkspaceLoader(),o&&(r=`/api/Blockly/GetPublishedTemplate?versionId=${o}`);try{const n=await apiClient.get(r);if(hideBlocklyWorkspaceLoader(),console.log("GetPublishedTemplate response:",n),n.headers["content-length"]<55){showToast("This template has no blocks to display","error"),showBlocklyWorkspaceErrorMsg("This template has no blocks to display"),disableSaveScriptButton();return}workspace.getAllBlocks(!1).length>0&&workspace.clear();let i=Blockly$1.Xml.textToDom(n?.data);Blockly$1.Xml.domToWorkspace(workspace,i)}catch(n){showToast("Error loading template","error"),hideBlocklyWorkspaceLoader(),showBlocklyWorkspaceErrorMsg("Blockly Template Not Found"),console.error("Error during API request:",n)}}Blockly$1.JavaScript.bi_console_log=function(e){var t=Blockly$1.JavaScript.valueToCode(e,"LOG_VALUE",Blockly$1.JavaScript.ORDER_NONE),o="console.log("+t+`);
`;return o};async function loadTemplateList(){console.log("%c-----> ENTERED:  loadTemplateList() <-----","color: #34eb34;");try{templateListData=await apiClient.get("/api/Configuration/GetBlocklyTemplates"),console.log("templateListData:",templateListData);const t=DOM_ELEMENT.templateSelector;t.textContent="";const o=document.createElement("option");o.textContent="Select an item",o.value="",o.disabled=!0,o.selected=!0,o.hidden=!0;const r=document.createElement("optgroup");r.label="Global";const n=document.createElement("optgroup");n.label="Custom",templateListData?.data?.forEach(s=>{const i=document.createElement("option");i.value=s.templateid,i.textContent=`${s.templateName} ${s.isPublish?"":" (Draft)"}`,s.isPublish||i.classList.add("draft-option"),s.type===1?(userRole==="3"||s.isPublish)&&r.appendChild(i):s.type===2&&n.appendChild(i)}),r.children.length>0&&t.appendChild(r),n.children.length>0&&t.appendChild(n)}catch(e){showToast(`Error loading template list: ${e}`,"error")}}async function getNumberOfVersions(e){if(e)try{const t=await apiClient.get(`/api/Blockly/GetVersionList?templateid=${e}`);t?.data?.length>0?numberOfVersions=t.data.length+1:numberOfVersions=1}catch(t){showToast(`Error getting version list: ${t}`,"fail"),console.error("Error getting version list: ",t)}}async function getVersionList(e){if(console.log("%c-----> ENTERED:  getVersionList() <-----","color: #34eb34;"),!!e)try{const t=await apiClient.get(`/api/Blockly/GetVersionList?templateid=${e}`);if(console.log("response: ",t),t?.data?.length>0){numberOfVersions=t.data.length+1,isPublished=!0,DOM_ELEMENT.deleteTemplateButton.textContent="Delete Template";const o=DOM_ELEMENT.versionListSelector;o.innerHTML="",t.data.forEach(r=>{const n=document.createElement("option");n.value=r.id,n.textContent=r.versionName.toLowerCase().trim()==="default_template"?r.versionName:convertUTCToLocal(r.versionName),o.appendChild(n)}),o.selectedIndex=o.options.length-1,console.log("Latest version selected:",o.value),publishedVersionListItem=o.value}else numberOfVersions=1,isPublished=!1,DOM_ELEMENT.deleteTemplateButton.textContent="Discard Draft",DOM_ELEMENT.versionListSelector.textContent=""}catch(t){showToast("Version listing failed","fail"),console.error("VERSION HISTORY LISTING ERROR:",t)}}function templateListDropdownChangeHandler(e=void 0){if(console.log("%c-----> ENTERED:  templateListDropdownChangeHandler() <-----","color: #34eb34;"),selectedOption=getSelectedTemplateOption(),!selectedOption){console.warn("Selected template not found in data");return}console.log("selectedOption:",selectedOption);const t=selectedOption.templateName.trim()||"";console.log("selectedTemplateName:",t);const o=selectedOption.type;console.log("templateType:",o),isGlobalTemplate=o===1,isDefaultTemplate=t.toLowerCase()==="default_template",isPublished=selectedOption.isPublish,console.log("isPublished:",isPublished),updateDeleteButtonText();let r=selectedOption.description;console.log("typeof description:",typeof r),DOM_ELEMENT.templateDescription.value=r&&r!=="null"?r:"",console.log("DOM_ELEMENT.templateDescription.value:",DOM_ELEMENT.templateDescription.value),DOM_ELEMENT.nameField.value=t?t.replace("(Draft)","").trim():"",isGlobalTemplate&&userRole!="3"||isDefaultTemplate?DOM_ELEMENT.deleteTemplateButton.disabled=!0:DOM_ELEMENT.deleteTemplateButton.disabled=!1,isPublished!==!1?(DOM_ELEMENT.versionListSelector.disabled=!1,getVersionList(selectedTemplateId)):(DOM_ELEMENT.versionListSelector.textContent="",DOM_ELEMENT.versionListSelector.disabled=!0),showNameValidation(!1)}function versionListElementChangeHandler(e){console.log("%c-----> ENTERED:  versionListElementChangeHandler() <-----","color: #34eb34;"),disableSaveScriptButton(),loadBlocklyMapping(void 0,void 0,e)}async function uploadTemplateXML(e,t,o,r){console.log("%c-----> ENTERED:  uploadTemplateXML() <-----","color: #34eb34;");try{const n=new FormData,s=new Blob([t],{type:"text/xml"});if(n.append("TemplateFile",s,`${e}.xml`),n.append("blocklyId",blocklyIdFromMainApp),n.append("TemplateName",e),n.append("Description",DOM_ELEMENT.templateDescription.value),(o==="update"||o==="save-script")&&n.append("templateId",r),await apiClient.post("/api/Configuration/PostBlocklyTemplate",n,{headers:{"Content-Type":"multipart/form-data"}}),showToast(`Template ${o==="update"?"Updated":"Saved"} Successfully`,"success"),showNameValidation(!1),disableSaveScriptButton(),o==="update"){await loadTemplateList();const a=selectedOption;if(a.templateid)DOM_ELEMENT.templateSelector.value=String(a.templateid);else{const u=DOM_ELEMENT.nameField.value.trim();console.warn("Template not found in list:",u)}templateListDropdownChangeHandler(),hideSaveAsDraftButtonLoader()}else if(o==="new"){resetRightEditor(),await loadTemplateList();const a=DOM_ELEMENT.nameField.value;console.log("templateNameToSelect:",a);const u=templateListData.data.find(c=>c.templateName?c.templateName.trim()===a.trim():(console.log("Not found 1"),!1));console.log("foundTemplate:",u),console.log("String(foundTemplate.templateid):",String(u.templateid)),console.log("DOM_ELEMENT.templateSelector.value:",DOM_ELEMENT.templateSelector.value),u?DOM_ELEMENT.templateSelector.value=String(u.templateid):console.warn("Template not found in list:",a),templateListDropdownChangeHandler(),hideSaveAsDraftButtonLoader()}}catch(n){console.error("Error during API request:",n),showToast("Error while creating or saving...","fail"),n.response?.status===409&&showNameValidation(!0),hideSaveAsDraftButtonLoader()}}async function saveOrUpdateWorkspace(e,t,o){console.log("%c-----> ENTERED:  saveOrUpdateWorkspace() <-----","color: #34eb34;");const r=e.trim();if(showSaveAsDraftButtonLoader(),r.length>0){var n=Blockly$1.getMainWorkspace(),s=Blockly$1.Xml.workspaceToDom(n),i=Blockly$1.Xml.domToText(s);await uploadTemplateXML(r,i,t,o)}else showToast("Please select a template","fail"),hideSaveAsDraftButtonLoader(),DOM_ELEMENT.nameField.classList.add("border-red-500","ring-red-500"),DOM_ELEMENT.invalidMessageText.classList.add("hidden")}async function saveScriptAndPublish(e){console.log("%c-----> ENTERED:  saveScriptAndPublish() <-----","color: #34eb34;");let t=DOM_ELEMENT.nameField.value;showScriptButtonLoader();try{await saveOrUpdateWorkspace(t,"save-script",e),await getNumberOfVersions(e),numberOfVersions||(numberOfVersions=1)}catch{showToast("Error while saving workspace. Publishing stopped.","fail"),hideScriptButtonLoader();return}let o;o=`let globalWindow = {}; ${window.generatedScript.replace("window.mappedData = main(window.window.parsedXml)","").replace("window.rightEditor.set(window.mappedData);","").replace("function main(ccdaJson){","function main(ccdaJson){globalWindow.parsedXml = ccdaJson;").replaceAll("window","globalWindow")}`;var n=Blockly$1.getMainWorkspace(),s=Blockly$1.Xml.workspaceToDom(n),i=Blockly$1.Xml.domToText(s);const a=new FormData,u=new Blob([o],{type:"application/javascript"});a.append("script",u,"nifi_script.js");const c=new Blob([i],{type:"text/xml"});a.append("file",c,`${t}.xml`),a.append("blocklyId",blocklyIdFromMainApp);try{await apiClient.put(`api/Blockly/PublishTemplate?templateId=${encodeURIComponent(e)}&versionName=R${numberOfVersions}`,a,{headers:{"Content-Type":"multipart/form-data"}}),hideScriptButtonLoader(),await loadTemplateList();const d=selectedOption;if(d.templateid)DOM_ELEMENT.templateSelector.value=String(d.templateid);else{const h=DOM_ELEMENT.nameField.value.trim();console.warn("Template not found in list:",h)}templateListDropdownChangeHandler(),showToast("Template successfully published","success"),disableSaveScriptButton()}catch(d){showToast(`Error while publishing: ${d}`,"fail"),hideScriptButtonLoader()}}async function loadSavedBlockTemplate(e){console.log("%c-----> ENTERED:  loadSavedBlockTemplate() <-----","color: #34eb34;"),hideBlocklyWorkspaceErrorMsg(),showBlocklyWorkspaceLoader();try{const t=await apiClient.get(`/api/Blockly/LoadTemplate?templateId=${e}`);if(hideBlocklyWorkspaceLoader(),t.headers["content-length"]<55){showToast("This template has no blocks to display","error"),showBlocklyWorkspaceErrorMsg("This template has no blocks to display"),disableSaveScriptButton();return}workspace.getAllBlocks(!1).length>0&&workspace.clear();let r=Blockly$1.Xml.textToDom(t?.data);Blockly$1.Xml.domToWorkspace(workspace,r),showToast("Template Loaded Successfully","success"),resetRightEditor(),isPublished||(console.log("isPublished is false, clearing versionListSelector."),DOM_ELEMENT.versionListSelector.textContent=""),disableSaveScriptButton()}catch(t){showToast("Template Failed to Load","fail"),hideBlocklyWorkspaceLoader(),showBlocklyWorkspaceErrorMsg("Blockly Template Not Found"),console.error("Error during API request:",t)}}async function deleteBlocklyTemplate(e){console.log("%c-----> ENTERED:  deleteBlocklyTemplate() <-----","color: #34eb34;");try{if(await apiClient.delete(`/api/Configuration/DeleteBlocklyTemplate?templateid=${e}`),showToast(isPublished!==!1?"Template Deleted Successfully":"Draft discarded Successfully","success"),workspace.getAllBlocks(!1).length>0&&workspace.clear(),await loadTemplateList(),isPublished!==!1){const r=templateListData.data.find(n=>n.templateName.toLowerCase().trim()==="default_template").templateid;loadSavedBlockTemplate(r)}else{const o=DOM_ELEMENT.nameField.value;console.log("templateNameToSelect:",o);const r=templateListData.data.find(n=>n.templateName?n.templateName.trim()===o.trim():(console.log("Not found 1"),!1));if(r)DOM_ELEMENT.templateSelector.value=String(r.templateid);else{const s=templateListData.data.find(i=>i.templateName.toLowerCase().trim()==="default_template").templateid;loadSavedBlockTemplate(s)}}templateListDropdownChangeHandler(),resetRightEditor(),disableSaveScriptButton()}catch(t){isPublished!==!1?(console.error("Error during API request:",t),showToast("Failed to delete template","fail")):showToast("Failed to discard draft","fail")}finally{showNameValidation(!1)}}function createStandardsDropdown(e){const t=document.createElement("option");t.value="",t.textContent="Select a standard",t.disabled=!0,t.selected=!0,DOM_ELEMENT.switchFromSelector.appendChild(t);const o=document.createElement("option");o.value="",o.textContent="Select a standard",o.disabled=!0,o.selected=!0,DOM_ELEMENT.switchToSelector.appendChild(o),e.forEach(r=>{const n=document.createElement("optgroup");n.label=r.standard;const s=document.createElement("optgroup");s.label=r.standard,r.versions.forEach(i=>{const a=document.createElement("option");a.value=`${r.standard} - ${i}`,a.textContent=i,n.appendChild(a);const u=document.createElement("option");u.value=`${r.standard} - ${i}`,u.textContent=i,s.appendChild(u)}),DOM_ELEMENT.switchFromSelector.appendChild(n),DOM_ELEMENT.switchToSelector.appendChild(s)})}async function getStandardsWithVersions(){try{const e=await apiClient.get("/api/Configuration/GetStandards");createStandardsDropdown(e.data)}catch(e){console.error("Error during API request:",e)}}
