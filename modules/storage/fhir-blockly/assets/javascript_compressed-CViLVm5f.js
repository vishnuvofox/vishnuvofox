import{g as u}from"./_commonjsHelpers-Cpj98o6Y.js";function R(e,t){for(var a=0;a<t.length;a++){const r=t[a];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const n=Object.getOwnPropertyDescriptor(r,i);n&&Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var v=function(e){return e.JavaScript=new e.Generator("JavaScript"),e.JavaScript.addReservedWords("Blockly,break,case,catch,continue,debugger,default,delete,do,else,finally,for,function,if,in,instanceof,new,return,switch,this,throw,try,typeof,var,void,while,with,class,enum,export,extends,import,super,implements,interface,let,package,private,protected,public,static,yield,const,null,true,false,Array,ArrayBuffer,Boolean,Date,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Error,eval,EvalError,Float32Array,Float64Array,Function,Infinity,Int16Array,Int32Array,Int8Array,isFinite,isNaN,Iterator,JSON,Math,NaN,Number,Object,parseFloat,parseInt,RangeError,ReferenceError,RegExp,StopIteration,String,SyntaxError,TypeError,Uint16Array,Uint32Array,Uint8Array,Uint8ClampedArray,undefined,uneval,URIError,applicationCache,closed,Components,content,_content,controllers,crypto,defaultStatus,dialogArguments,directories,document,frameElement,frames,fullScreen,globalStorage,history,innerHeight,innerWidth,length,location,locationbar,localStorage,menubar,messageManager,mozAnimationStartTime,mozInnerScreenX,mozInnerScreenY,mozPaintCount,name,navigator,opener,outerHeight,outerWidth,pageXOffset,pageYOffset,parent,performance,personalbar,pkcs11,returnValue,screen,screenX,screenY,scrollbars,scrollMaxX,scrollMaxY,scrollX,scrollY,self,sessionStorage,sidebar,status,statusbar,toolbar,top,URL,window,addEventListener,alert,atob,back,blur,btoa,captureEvents,clearImmediate,clearInterval,clearTimeout,close,confirm,disableExternalCapture,dispatchEvent,dump,enableExternalCapture,escape,find,focus,forward,GeckoActiveXObject,getAttention,getAttentionWithCycleCount,getComputedStyle,getSelection,home,matchMedia,maximize,minimize,moveBy,moveTo,mozRequestAnimationFrame,open,openDialog,postMessage,print,prompt,QueryInterface,releaseEvents,removeEventListener,resizeBy,resizeTo,restore,routeEvent,scroll,scrollBy,scrollByLines,scrollByPages,scrollTo,setCursor,setImmediate,setInterval,setResizable,setTimeout,showModalDialog,sizeToContent,stop,unescape,updateCommands,XPCNativeWrapper,XPCSafeJSObjectWrapper,onabort,onbeforeunload,onblur,onchange,onclick,onclose,oncontextmenu,ondevicemotion,ondeviceorientation,ondragdrop,onerror,onfocus,onhashchange,onkeydown,onkeypress,onkeyup,onload,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup,onmozbeforepaint,onpaint,onpopstate,onreset,onresize,onscroll,onselect,onsubmit,onunload,onpageshow,onpagehide,Image,Option,Worker,Event,Range,File,FileReader,Blob,BlobBuilder,Attr,CDATASection,CharacterData,Comment,console,DocumentFragment,DocumentType,DomConfiguration,DOMError,DOMErrorHandler,DOMException,DOMImplementation,DOMImplementationList,DOMImplementationRegistry,DOMImplementationSource,DOMLocator,DOMObject,DOMString,DOMStringList,DOMTimeStamp,DOMUserData,Entity,EntityReference,MediaQueryList,MediaQueryListListener,NameList,NamedNodeMap,Node,NodeFilter,NodeIterator,NodeList,Notation,Plugin,PluginArray,ProcessingInstruction,SharedWorker,Text,TimeRanges,Treewalker,TypeInfo,UserDataHandler,Worker,WorkerGlobalScope,HTMLDocument,HTMLElement,HTMLAnchorElement,HTMLAppletElement,HTMLAudioElement,HTMLAreaElement,HTMLBaseElement,HTMLBaseFontElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLKeygenElement,HTMLLabelElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMenuElement,HTMLMetaElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableCellElement,HTMLTableDataCellElement,HTMLTableHeaderCellElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTimeElement,HTMLTitleElement,HTMLTrackElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement,HTMLCanvasElement,CanvasRenderingContext2D,CanvasGradient,CanvasPattern,TextMetrics,ImageData,CanvasPixelArray,HTMLAudioElement,HTMLVideoElement,NotifyAudioAvailableEvent,HTMLCollection,HTMLAllCollection,HTMLFormControlsCollection,HTMLOptionsCollection,HTMLPropertiesCollection,DOMTokenList,DOMSettableTokenList,DOMStringMap,RadioNodeList,SVGDocument,SVGElement,SVGAElement,SVGAltGlyphElement,SVGAltGlyphDefElement,SVGAltGlyphItemElement,SVGAnimationElement,SVGAnimateElement,SVGAnimateColorElement,SVGAnimateMotionElement,SVGAnimateTransformElement,SVGSetElement,SVGCircleElement,SVGClipPathElement,SVGColorProfileElement,SVGCursorElement,SVGDefsElement,SVGDescElement,SVGEllipseElement,SVGFilterElement,SVGFilterPrimitiveStandardAttributes,SVGFEBlendElement,SVGFEColorMatrixElement,SVGFEComponentTransferElement,SVGFECompositeElement,SVGFEConvolveMatrixElement,SVGFEDiffuseLightingElement,SVGFEDisplacementMapElement,SVGFEDistantLightElement,SVGFEFloodElement,SVGFEGaussianBlurElement,SVGFEImageElement,SVGFEMergeElement,SVGFEMergeNodeElement,SVGFEMorphologyElement,SVGFEOffsetElement,SVGFEPointLightElement,SVGFESpecularLightingElement,SVGFESpotLightElement,SVGFETileElement,SVGFETurbulenceElement,SVGComponentTransferFunctionElement,SVGFEFuncRElement,SVGFEFuncGElement,SVGFEFuncBElement,SVGFEFuncAElement,SVGFontElement,SVGFontFaceElement,SVGFontFaceFormatElement,SVGFontFaceNameElement,SVGFontFaceSrcElement,SVGFontFaceUriElement,SVGForeignObjectElement,SVGGElement,SVGGlyphElement,SVGGlyphRefElement,SVGGradientElement,SVGLinearGradientElement,SVGRadialGradientElement,SVGHKernElement,SVGImageElement,SVGLineElement,SVGMarkerElement,SVGMaskElement,SVGMetadataElement,SVGMissingGlyphElement,SVGMPathElement,SVGPathElement,SVGPatternElement,SVGPolylineElement,SVGPolygonElement,SVGRectElement,SVGScriptElement,SVGStopElement,SVGStyleElement,SVGSVGElement,SVGSwitchElement,SVGSymbolElement,SVGTextElement,SVGTextPathElement,SVGTitleElement,SVGTRefElement,SVGTSpanElement,SVGUseElement,SVGViewElement,SVGVKernElement,SVGAngle,SVGColor,SVGICCColor,SVGElementInstance,SVGElementInstanceList,SVGLength,SVGLengthList,SVGMatrix,SVGNumber,SVGNumberList,SVGPaint,SVGPoint,SVGPointList,SVGPreserveAspectRatio,SVGRect,SVGStringList,SVGTransform,SVGTransformList,SVGAnimatedAngle,SVGAnimatedBoolean,SVGAnimatedEnumeration,SVGAnimatedInteger,SVGAnimatedLength,SVGAnimatedLengthList,SVGAnimatedNumber,SVGAnimatedNumberList,SVGAnimatedPreserveAspectRatio,SVGAnimatedRect,SVGAnimatedString,SVGAnimatedTransformList,SVGPathSegList,SVGPathSeg,SVGPathSegArcAbs,SVGPathSegArcRel,SVGPathSegClosePath,SVGPathSegCurvetoCubicAbs,SVGPathSegCurvetoCubicRel,SVGPathSegCurvetoCubicSmoothAbs,SVGPathSegCurvetoCubicSmoothRel,SVGPathSegCurvetoQuadraticAbs,SVGPathSegCurvetoQuadraticRel,SVGPathSegCurvetoQuadraticSmoothAbs,SVGPathSegCurvetoQuadraticSmoothRel,SVGPathSegLinetoAbs,SVGPathSegLinetoHorizontalAbs,SVGPathSegLinetoHorizontalRel,SVGPathSegLinetoRel,SVGPathSegLinetoVerticalAbs,SVGPathSegLinetoVerticalRel,SVGPathSegMovetoAbs,SVGPathSegMovetoRel,ElementTimeControl,TimeEvent,SVGAnimatedPathData,SVGAnimatedPoints,SVGColorProfileRule,SVGCSSRule,SVGExternalResourcesRequired,SVGFitToViewBox,SVGLangSpace,SVGLocatable,SVGRenderingIntent,SVGStylable,SVGTests,SVGTextContentElement,SVGTextPositioningElement,SVGTransformable,SVGUnitTypes,SVGURIReference,SVGViewSpec,SVGZoomAndPan"),e.JavaScript.ORDER_ATOMIC=0,e.JavaScript.ORDER_MEMBER=1,e.JavaScript.ORDER_NEW=1,e.JavaScript.ORDER_FUNCTION_CALL=2,e.JavaScript.ORDER_INCREMENT=3,e.JavaScript.ORDER_DECREMENT=3,e.JavaScript.ORDER_LOGICAL_NOT=4,e.JavaScript.ORDER_BITWISE_NOT=4,e.JavaScript.ORDER_UNARY_PLUS=4,e.JavaScript.ORDER_UNARY_NEGATION=4,e.JavaScript.ORDER_TYPEOF=4,e.JavaScript.ORDER_VOID=4,e.JavaScript.ORDER_DELETE=4,e.JavaScript.ORDER_MULTIPLICATION=5,e.JavaScript.ORDER_DIVISION=5,e.JavaScript.ORDER_MODULUS=5,e.JavaScript.ORDER_ADDITION=6,e.JavaScript.ORDER_SUBTRACTION=6,e.JavaScript.ORDER_BITWISE_SHIFT=7,e.JavaScript.ORDER_RELATIONAL=8,e.JavaScript.ORDER_IN=8,e.JavaScript.ORDER_INSTANCEOF=8,e.JavaScript.ORDER_EQUALITY=9,e.JavaScript.ORDER_BITWISE_AND=10,e.JavaScript.ORDER_BITWISE_XOR=11,e.JavaScript.ORDER_BITWISE_OR=12,e.JavaScript.ORDER_LOGICAL_AND=13,e.JavaScript.ORDER_LOGICAL_OR=14,e.JavaScript.ORDER_CONDITIONAL=15,e.JavaScript.ORDER_ASSIGNMENT=16,e.JavaScript.ORDER_COMMA=17,e.JavaScript.ORDER_NONE=99,e.JavaScript.init=function(t){e.JavaScript.definitions_=Object.create(null),e.JavaScript.functionNames_=Object.create(null),e.JavaScript.variableDB_?e.JavaScript.variableDB_.reset():e.JavaScript.variableDB_=new e.Names(e.JavaScript.RESERVED_WORDS_);var a=[];t=e.Variables.allVariables(t);for(var r=0;r<t.length;r++)a[r]="var "+e.JavaScript.variableDB_.getName(t[r],e.Variables.NAME_TYPE)+";";e.JavaScript.definitions_.variables=a.join(`
`)},e.JavaScript.finish=function(t){var a=[],r;for(r in e.JavaScript.definitions_)a.push(e.JavaScript.definitions_[r]);return delete e.JavaScript.definitions_,delete e.JavaScript.functionNames_,e.JavaScript.variableDB_.reset(),a.join(`

`)+`


`+t},e.JavaScript.scrubNakedValue=function(t){return t+`;
`},e.JavaScript.quote_=function(t){return t=t.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+t+"'"},e.JavaScript.scrub_=function(t,a){var r="";if(!t.outputConnection||!t.outputConnection.targetConnection){var i=t.getCommentText();i&&(r+=e.JavaScript.prefixLines(i,"// ")+`
`);for(var n=0;n<t.inputList.length;n++)t.inputList[n].type==e.INPUT_VALUE&&(i=t.inputList[n].connection.targetBlock())&&(i=e.JavaScript.allNestedComments(i))&&(r+=e.JavaScript.prefixLines(i,"// "))}return n=t.nextConnection&&t.nextConnection.targetBlock(),n=e.JavaScript.blockToCode(n),r+a+n},e.JavaScript.colour={},e.JavaScript.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.colour_random=function(t){return[e.JavaScript.provideFunction_("colour_random",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_rgb=function(t){var a=e.JavaScript.valueToCode(t,"RED",e.JavaScript.ORDER_COMMA)||0,r=e.JavaScript.valueToCode(t,"GREEN",e.JavaScript.ORDER_COMMA)||0;return t=e.JavaScript.valueToCode(t,"BLUE",e.JavaScript.ORDER_COMMA)||0,[e.JavaScript.provideFunction_("colour_rgb",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+a+", "+r+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_blend=function(t){var a=e.JavaScript.valueToCode(t,"COLOUR1",e.JavaScript.ORDER_COMMA)||"'#000000'",r=e.JavaScript.valueToCode(t,"COLOUR2",e.JavaScript.ORDER_COMMA)||"'#000000'";return t=e.JavaScript.valueToCode(t,"RATIO",e.JavaScript.ORDER_COMMA)||.5,[e.JavaScript.provideFunction_("colour_blend",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+a+", "+r+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists={},e.JavaScript.lists_create_empty=function(t){return["[]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_create_with=function(t){for(var a=Array(t.itemCount_-1),r=1;r<t.itemCount_;r++)a[r-1]=e.JavaScript.valueToCode(t,"items"+r,e.JavaScript.ORDER_COMMA)||"null";return["["+a.join(", ")+"]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_repeat=function(t){var a=e.JavaScript.provideFunction_("lists_repeat",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"]),r=e.JavaScript.valueToCode(t,"ITEM",e.JavaScript.ORDER_COMMA)||"null";return t=e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_COMMA)||"0",[a+"("+r+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_length=function(t){return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.lists_isEmpty=function(t){return["!"+(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.lists_indexOf=function(t){var a=t.getFieldValue("END")=="FIRST"?"indexOf":"lastIndexOf",r=e.JavaScript.valueToCode(t,"FIND",e.JavaScript.ORDER_NONE)||"''";return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+"."+a+"("+r+") + 1",e.JavaScript.ORDER_MEMBER]},e.JavaScript.lists_getIndex=function(t){var a=t.getFieldValue("MODE")||"GET",r=t.getFieldValue("WHERE")||"FROM_START",i=e.JavaScript.valueToCode(t,"AT",e.JavaScript.ORDER_UNARY_NEGATION)||"1";if(t=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]",r=="FIRST"){if(a=="GET")return[t+"[0]",e.JavaScript.ORDER_MEMBER];if(a=="GET_REMOVE")return[t+".shift()",e.JavaScript.ORDER_MEMBER];if(a=="REMOVE")return t+`.shift();
`}else if(r=="LAST"){if(a=="GET")return[t+".slice(-1)[0]",e.JavaScript.ORDER_MEMBER];if(a=="GET_REMOVE")return[t+".pop()",e.JavaScript.ORDER_MEMBER];if(a=="REMOVE")return t+`.pop();
`}else if(r=="FROM_START"){if(i=e.isNumber(i)?parseFloat(i)-1:i+" - 1",a=="GET")return[t+"["+i+"]",e.JavaScript.ORDER_MEMBER];if(a=="GET_REMOVE")return[t+".splice("+i+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if(a=="REMOVE")return t+".splice("+i+`, 1);
`}else if(r=="FROM_END"){if(a=="GET")return[t+".slice(-"+i+")[0]",e.JavaScript.ORDER_FUNCTION_CALL];if(a=="GET_REMOVE"||a=="REMOVE"){if(r=e.JavaScript.provideFunction_("lists_remove_from_end",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, x) {","  x = list.length - x;","  return list.splice(x, 1)[0];","}"]),i=r+"("+t+", "+i+")",a=="GET_REMOVE")return[i,e.JavaScript.ORDER_FUNCTION_CALL];if(a=="REMOVE")return i+`;
`}}else if(r=="RANDOM"){if(r=e.JavaScript.provideFunction_("lists_get_random_item",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"]),i=r+"("+t+", "+(a!="GET")+")",a=="GET"||a=="GET_REMOVE")return[i,e.JavaScript.ORDER_FUNCTION_CALL];if(a=="REMOVE")return i+`;
`}throw"Unhandled combination (lists_getIndex)."},e.JavaScript.lists_setIndex=function(t){function a(){if(r.match(/^\w+$/))return"";var E=e.JavaScript.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE),p="var "+E+" = "+r+`;
`;return r=E,p}var r=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",i=t.getFieldValue("MODE")||"GET",n=t.getFieldValue("WHERE")||"FROM_START",S=e.JavaScript.valueToCode(t,"AT",e.JavaScript.ORDER_NONE)||"1";if(t=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"null",n=="FIRST"){if(i=="SET")return r+"[0] = "+t+`;
`;if(i=="INSERT")return r+".unshift("+t+`);
`}else if(n=="LAST"){if(i=="SET")return n=a(),n+(r+"["+r+".length - 1] = "+t+`;
`);if(i=="INSERT")return r+".push("+t+`);
`}else if(n=="FROM_START"){if(S=e.isNumber(S)?parseFloat(S)-1:S+" - 1",i=="SET")return r+"["+S+"] = "+t+`;
`;if(i=="INSERT")return r+".splice("+S+", 0, "+t+`);
`}else if(n=="FROM_END"){if(n=a(),i=="SET")return n+(r+"["+r+".length - "+S+"] = "+t+`;
`);if(i=="INSERT")return n+(r+".splice("+r+".length - "+S+", 0, "+t+`);
`)}else if(n=="RANDOM"){if(n=a(),S=e.JavaScript.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE),n+="var "+S+" = Math.floor(Math.random() * "+r+`.length);
`,i=="SET")return n+(r+"["+S+"] = "+t+`;
`);if(i=="INSERT")return n+(r+".splice("+S+", 0, "+t+`);
`)}throw"Unhandled combination (lists_setIndex)."},e.JavaScript.lists_getSublist=function(t){var a=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",r=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),n=e.JavaScript.valueToCode(t,"AT1",e.JavaScript.ORDER_NONE)||"1";return t=e.JavaScript.valueToCode(t,"AT2",e.JavaScript.ORDER_NONE)||"1",[r=="FIRST"&&i=="LAST"?a+".concat()":e.JavaScript.provideFunction_("lists_get_sublist",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, where1, at1, where2, at2) {","  function getAt(where, at) {","    if (where == 'FROM_START') {","      at--;","    } else if (where == 'FROM_END') {","      at = list.length - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = list.length - 1;","    } else {","      throw 'Unhandled option (lists_getSublist).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return list.slice(at1, at2);","}"])+"("+a+", '"+r+"', "+n+", '"+i+"', "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_split=function(t){var a=e.JavaScript.valueToCode(t,"INPUT",e.JavaScript.ORDER_MEMBER),r=e.JavaScript.valueToCode(t,"DELIM",e.JavaScript.ORDER_NONE)||"''";if(t=t.getFieldValue("MODE"),t=="SPLIT")a||(a="''"),t="split";else if(t=="JOIN")a||(a="[]"),t="join";else throw"Unknown mode: "+t;return[a+"."+t+"("+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.logic={},e.JavaScript.controls_if=function(t){for(var n=0,a=e.JavaScript.valueToCode(t,"IF"+n,e.JavaScript.ORDER_NONE)||"false",r=e.JavaScript.statementToCode(t,"DO"+n),i="if ("+a+`) {
`+r+"}",n=1;n<=t.elseifCount_;n++)a=e.JavaScript.valueToCode(t,"IF"+n,e.JavaScript.ORDER_NONE)||"false",r=e.JavaScript.statementToCode(t,"DO"+n),i+=" else if ("+a+`) {
`+r+"}";return t.elseCount_&&(r=e.JavaScript.statementToCode(t,"ELSE"),i+=` else {
`+r+"}"),i+`
`},e.JavaScript.logic_compare=function(t){var a={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],r=a=="=="||a=="!="?e.JavaScript.ORDER_EQUALITY:e.JavaScript.ORDER_RELATIONAL,i=e.JavaScript.valueToCode(t,"A",r)||"0";return t=e.JavaScript.valueToCode(t,"B",r)||"0",[i+" "+a+" "+t,r]},e.JavaScript.logic_operation=function(t){var a=t.getFieldValue("OP")=="AND"?"&&":"||",r=a=="&&"?e.JavaScript.ORDER_LOGICAL_AND:e.JavaScript.ORDER_LOGICAL_OR,i=e.JavaScript.valueToCode(t,"A",r);if(t=e.JavaScript.valueToCode(t,"B",r),i||t){var n=a=="&&"?"true":"false";i||(i=n),t||(t=n)}else t=i="false";return[i+" "+a+" "+t,r]},e.JavaScript.logic_negate=function(t){var a=e.JavaScript.ORDER_LOGICAL_NOT;return["!"+(e.JavaScript.valueToCode(t,"BOOL",a)||"true"),a]},e.JavaScript.logic_boolean=function(t){return[t.getFieldValue("BOOL")=="TRUE"?"true":"false",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_null=function(t){return["null",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_ternary=function(t){var a=e.JavaScript.valueToCode(t,"IF",e.JavaScript.ORDER_CONDITIONAL)||"false",r=e.JavaScript.valueToCode(t,"THEN",e.JavaScript.ORDER_CONDITIONAL)||"null";return t=e.JavaScript.valueToCode(t,"ELSE",e.JavaScript.ORDER_CONDITIONAL)||"null",[a+" ? "+r+" : "+t,e.JavaScript.ORDER_CONDITIONAL]},e.JavaScript.loops={},e.JavaScript.controls_repeat_ext=function(t){var a=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):e.JavaScript.valueToCode(t,"TIMES",e.JavaScript.ORDER_ASSIGNMENT)||"0",r=e.JavaScript.statementToCode(t,"DO"),r=e.JavaScript.addLoopTrap(r,t.id);t="";var i=e.JavaScript.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE),n=a;return a.match(/^\w+$/)||e.isNumber(a)||(n=e.JavaScript.variableDB_.getDistinctName("repeat_end",e.Variables.NAME_TYPE),t+="var "+n+" = "+a+`;
`),t+("for (var "+i+" = 0; "+i+" < "+n+"; "+i+`++) {
`+r+`}
`)},e.JavaScript.controls_repeat=e.JavaScript.controls_repeat_ext,e.JavaScript.controls_whileUntil=function(t){var a=t.getFieldValue("MODE")=="UNTIL",r=e.JavaScript.valueToCode(t,"BOOL",a?e.JavaScript.ORDER_LOGICAL_NOT:e.JavaScript.ORDER_NONE)||"false",i=e.JavaScript.statementToCode(t,"DO"),i=e.JavaScript.addLoopTrap(i,t.id);return a&&(r="!"+r),"while ("+r+`) {
`+i+`}
`},e.JavaScript.controls_for=function(t){var a=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),r=e.JavaScript.valueToCode(t,"FROM",e.JavaScript.ORDER_ASSIGNMENT)||"0",i=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"0",n=e.JavaScript.valueToCode(t,"BY",e.JavaScript.ORDER_ASSIGNMENT)||"1",S=e.JavaScript.statementToCode(t,"DO"),S=e.JavaScript.addLoopTrap(S,t.id);if(e.isNumber(r)&&e.isNumber(i)&&e.isNumber(n)){var E=parseFloat(r)<=parseFloat(i);t="for ("+a+" = "+r+"; "+a+(E?" <= ":" >= ")+i+"; "+a,a=Math.abs(parseFloat(n)),t=(a==1?t+(E?"++":"--"):t+((E?" += ":" -= ")+a))+(`) {
`+S+`}
`)}else t="",E=r,r.match(/^\w+$/)||e.isNumber(r)||(E=e.JavaScript.variableDB_.getDistinctName(a+"_start",e.Variables.NAME_TYPE),t+="var "+E+" = "+r+`;
`),r=i,i.match(/^\w+$/)||e.isNumber(i)||(r=e.JavaScript.variableDB_.getDistinctName(a+"_end",e.Variables.NAME_TYPE),t+="var "+r+" = "+i+`;
`),i=e.JavaScript.variableDB_.getDistinctName(a+"_inc",e.Variables.NAME_TYPE),t+="var "+i+" = ",t=e.isNumber(n)?t+(Math.abs(n)+`;
`):t+("Math.abs("+n+`);
`),t=t+("if ("+E+" > "+r+`) {
`)+(e.JavaScript.INDENT+i+" = -"+i+`;
`),t+=`}
`,t+="for ("+a+" = "+E+`;
     `+i+" >= 0 ? "+a+" <= "+r+" : "+a+" >= "+r+`;
     `+a+" += "+i+`) {
`+S+`}
`;return t},e.JavaScript.controls_forEach=function(t){var a=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),r=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_ASSIGNMENT)||"[]",i=e.JavaScript.statementToCode(t,"DO"),i=e.JavaScript.addLoopTrap(i,t.id);t="";var n=r;return r.match(/^\w+$/)||(n=e.JavaScript.variableDB_.getDistinctName(a+"_list",e.Variables.NAME_TYPE),t+="var "+n+" = "+r+`;
`),r=e.JavaScript.variableDB_.getDistinctName(a+"_index",e.Variables.NAME_TYPE),i=e.JavaScript.INDENT+a+" = "+n+"["+r+`];
`+i,t+("for (var "+r+" in "+n+`) {
`+i+`}
`)},e.JavaScript.controls_flow_statements=function(t){switch(t.getFieldValue("FLOW")){case"BREAK":return`break;
`;case"CONTINUE":return`continue;
`}throw"Unknown flow statement."},e.JavaScript.maps={},e.JavaScript.maps_create_empty=function(t){return["{}",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.maps_create_with=function(t){for(var a=Array(t.itemCount_-1),r=1;r<t.itemCount_;r++)a[r-1]=e.JavaScript.valueToCode(t,"ADD"+r,e.JavaScript.ORDER_COMMA)||"null";return["{"+a.join(", ")+"}",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.maps_length=function(t){return[(e.JavaScript.valueToCode(t,"MAP",e.JavaScript.ORDER_NONE)||"{}")+".length",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.maps_isempty=function(t){t=e.JavaScript.valueToCode(t,"MAP",e.JavaScript.ORDER_NONE)||"";var a=t+".length == 0";return t===""&&(a="true"),[a,e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.maps_create=function(t){var a=e.JavaScript.valueToCode(t,"VAL",e.JavaScript.ORDER_NONE)||"null";return[(e.JavaScript.valueToCode(t,"KEY",e.JavaScript.ORDER_NONE)||'""')+": "+a,e.JavaScript.ORDER_ATOMIC]},e.JavaScript.maps_getIndex=function(t){var a=t.getFieldValue("MODE")||"GET",r=e.JavaScript.valueToCode(t,"KEY",e.JavaScript.ORDER_NONE)||'""';if(t=e.JavaScript.valueToCode(t,"MAP",e.JavaScript.ORDER_MEMBER)||"",a=="GET")return[t+"["+r+"]",e.JavaScript.ORDER_MEMBER];if(a=="GET_REMOVE")return[t+"["+r+`];
`+("delete "+t+"["+r+"]"),e.JavaScript.ORDER_FUNCTION_CALL];if(a=="REMOVE")return"delete "+t+"["+r+`];
`;throw"Unhandled combination (maps_getIndex)."},e.JavaScript.maps_setIndex=function(t){var a=e.JavaScript.valueToCode(t,"MAP",e.JavaScript.ORDER_MEMBER)||"{}",r=e.JavaScript.valueToCode(t,"VAL",e.JavaScript.ORDER_NONE)||"null";return t=e.JavaScript.valueToCode(t,"KEY",e.JavaScript.ORDER_NONE)||'""',a+"["+t+"] = "+r+`;
`},e.JavaScript.maps_keys=function(t){return["Object.keys("+(e.JavaScript.valueToCode(t,"MAP",e.JavaScript.ORDER_NONE)||"{}")+")",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.controls_forEachKey=e.JavaScript.controls_forEach,e.JavaScript.math={},e.JavaScript.math_number=function(t){return[parseFloat(t.getFieldValue("NUM")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.math_arithmetic=function(t){var r={ADD:[" + ",e.JavaScript.ORDER_ADDITION],MINUS:[" - ",e.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",e.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",e.JavaScript.ORDER_DIVISION],POWER:[null,e.JavaScript.ORDER_COMMA]}[t.getFieldValue("OP")],a=r[0],r=r[1],i=e.JavaScript.valueToCode(t,"A",r)||"0";return t=e.JavaScript.valueToCode(t,"B",r)||"0",a?[i+a+t,r]:["Math.pow("+i+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_single=function(t){var a=t.getFieldValue("OP"),r;if(a=="NEG")return t=e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_UNARY_NEGATION)||"0",t[0]=="-"&&(t=" "+t),["-"+t,e.JavaScript.ORDER_UNARY_NEGATION];switch(t=a=="SIN"||a=="COS"||a=="TAN"?e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_DIVISION)||"0":e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_NONE)||"0",a){case"ABS":r="Math.abs("+t+")";break;case"ROOT":r="Math.sqrt("+t+")";break;case"LN":r="Math.log("+t+")";break;case"EXP":r="Math.exp("+t+")";break;case"POW10":r="Math.pow(10,"+t+")";break;case"ROUND":r="Math.round("+t+")";break;case"ROUNDUP":r="Math.ceil("+t+")";break;case"ROUNDDOWN":r="Math.floor("+t+")";break;case"SIN":r="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+t+" / 180 * Math.PI)"}if(r)return[r,e.JavaScript.ORDER_FUNCTION_CALL];switch(a){case"LOG10":r="Math.log("+t+") / Math.log(10)";break;case"ASIN":r="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+t+") / Math.PI * 180";break;default:throw"Unknown math operator: "+a}return[r,e.JavaScript.ORDER_DIVISION]},e.JavaScript.math_constant=function(t){return{PI:["Math.PI",e.JavaScript.ORDER_MEMBER],E:["Math.E",e.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",e.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",e.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",e.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",e.JavaScript.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},e.JavaScript.math_number_property=function(t){var a=e.JavaScript.valueToCode(t,"NUMBER_TO_CHECK",e.JavaScript.ORDER_MODULUS)||"0",r=t.getFieldValue("PROPERTY"),i;if(r=="PRIME")return[e.JavaScript.provideFunction_("math_isPrime",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+a+")",e.JavaScript.ORDER_FUNCTION_CALL];switch(r){case"EVEN":i=a+" % 2 == 0";break;case"ODD":i=a+" % 2 == 1";break;case"WHOLE":i=a+" % 1 == 0";break;case"POSITIVE":i=a+" > 0";break;case"NEGATIVE":i=a+" < 0";break;case"DIVISIBLE_BY":t=e.JavaScript.valueToCode(t,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0",i=a+" % "+t+" == 0"}return[i,e.JavaScript.ORDER_EQUALITY]},e.JavaScript.math_change=function(t){var a=e.JavaScript.valueToCode(t,"DELTA",e.JavaScript.ORDER_ADDITION)||"0";return t=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),t+" = (typeof "+t+" == 'number' ? "+t+" : 0) + "+a+`;
`},e.JavaScript.math_round=e.JavaScript.math_single,e.JavaScript.math_trig=e.JavaScript.math_single,e.JavaScript.math_on_list=function(t){var a=t.getFieldValue("OP");switch(a){case"SUM":t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_COMMA)||"[]",t="Math.min.apply(null, "+t+")";break;case"MAX":t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_COMMA)||"[]",t="Math.max.apply(null, "+t+")";break;case"AVERAGE":a=e.JavaScript.provideFunction_("math_mean",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]),t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]",t=a+"("+t+")";break;case"MEDIAN":a=e.JavaScript.provideFunction_("math_median",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]),t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]",t=a+"("+t+")";break;case"MODE":a=e.JavaScript.provideFunction_("math_modes",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]),t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]",t=a+"("+t+")";break;case"STD_DEV":a=e.JavaScript.provideFunction_("math_standard_deviation",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]),t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]",t=a+"("+t+")";break;case"RANDOM":a=e.JavaScript.provideFunction_("math_random_list",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]),t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]",t=a+"("+t+")";break;default:throw"Unknown operator: "+a}return[t,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_modulo=function(t){var a=e.JavaScript.valueToCode(t,"DIVIDEND",e.JavaScript.ORDER_MODULUS)||"0";return t=e.JavaScript.valueToCode(t,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0",[a+" % "+t,e.JavaScript.ORDER_MODULUS]},e.JavaScript.math_constrain=function(t){var a=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_COMMA)||"0",r=e.JavaScript.valueToCode(t,"LOW",e.JavaScript.ORDER_COMMA)||"0";return t=e.JavaScript.valueToCode(t,"HIGH",e.JavaScript.ORDER_COMMA)||"Infinity",["Math.min(Math.max("+a+", "+r+"), "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_int=function(t){var a=e.JavaScript.valueToCode(t,"FROM",e.JavaScript.ORDER_COMMA)||"0";return t=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_COMMA)||"0",[e.JavaScript.provideFunction_("math_random_int",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+a+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_float=function(t){return["Math.random()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures={},e.JavaScript.procedures_defreturn=function(t){var a=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),r=e.JavaScript.statementToCode(t,"STACK");e.JavaScript.STATEMENT_PREFIX&&(r=e.JavaScript.prefixLines(e.JavaScript.STATEMENT_PREFIX.replace(/%1/g,"'"+t.id+"'"),e.JavaScript.INDENT)+r),e.JavaScript.INFINITE_LOOP_TRAP&&(r=e.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t.id+"'")+r);var i=e.JavaScript.valueToCode(t,"RETURN",e.JavaScript.ORDER_NONE)||"";i&&(i="  return "+i+`;
`);for(var n=[],S=0;S<t.arguments_.length;S++)n[S]=e.JavaScript.variableDB_.getName(t.arguments_[S],e.Variables.NAME_TYPE);return r="function "+a+"("+n.join(", ")+`) {
`+r+i+"}",r=e.JavaScript.scrub_(t,r),e.JavaScript.definitions_[a]=r,null},e.JavaScript.procedures_defnoreturn=e.JavaScript.procedures_defreturn,e.JavaScript.procedures_callreturn=function(t){for(var a=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),r=[],i=0;i<t.arguments_.length;i++)r[i]=e.JavaScript.valueToCode(t,"ARG"+i,e.JavaScript.ORDER_COMMA)||"null";return[a+"("+r.join(", ")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures_callnoreturn=function(t){for(var a=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),r=[],i=0;i<t.arguments_.length;i++)r[i]=e.JavaScript.valueToCode(t,"ARG"+i,e.JavaScript.ORDER_COMMA)||"null";return a+"("+r.join(", ")+`);
`},e.JavaScript.procedures_ifreturn=function(t){var a="if ("+(e.JavaScript.valueToCode(t,"CONDITION",e.JavaScript.ORDER_NONE)||"false")+`) {
`;return t.hasReturnValue_?(t=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_NONE)||"null",a+="  return "+t+`;
`):a+=`  return;
`,a+`}
`},e.JavaScript.texts={},e.JavaScript.text=function(t){return[e.JavaScript.quote_(t.getFieldValue("TEXT")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.text_join=function(t){var a;if(t.itemCount_==0)return["''",e.JavaScript.ORDER_ATOMIC];if(t.itemCount_==1)return a=e.JavaScript.valueToCode(t,"ADD0",e.JavaScript.ORDER_NONE)||"''",["String("+a+")",e.JavaScript.ORDER_FUNCTION_CALL];if(t.itemCount_==2)return a=e.JavaScript.valueToCode(t,"ADD0",e.JavaScript.ORDER_NONE)||"''",t=e.JavaScript.valueToCode(t,"ADD1",e.JavaScript.ORDER_NONE)||"''",["String("+a+") + String("+t+")",e.JavaScript.ORDER_ADDITION];a=Array(t.itemCount_);for(var r=0;r<t.itemCount_;r++)a[r]=e.JavaScript.valueToCode(t,"ADD"+r,e.JavaScript.ORDER_COMMA)||"''";return a="["+a.join(",")+"].join('')",[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_append=function(t){var a=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE);return t=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''",a+" = String("+a+") + String("+t+`);
`},e.JavaScript.text_length=function(t){return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_isEmpty=function(t){return["!"+(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.text_indexOf=function(t){var a=t.getFieldValue("END")=="FIRST"?"indexOf":"lastIndexOf",r=e.JavaScript.valueToCode(t,"FIND",e.JavaScript.ORDER_NONE)||"''";return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+"."+a+"("+r+") + 1",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_charAt=function(t){var a=t.getFieldValue("WHERE")||"FROM_START",r=e.JavaScript.valueToCode(t,"AT",e.JavaScript.ORDER_UNARY_NEGATION)||"1";switch(t=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"''",a){case"FIRST":return[t+".charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[t+".slice(-1)",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return r=e.isNumber(r)?parseFloat(r)-1:r+" - 1",[t+".charAt("+r+")",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[t+".slice(-"+r+").charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[e.JavaScript.provideFunction_("text_random_letter",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+t+")",e.JavaScript.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt)."},e.JavaScript.text_getSubstring=function(t){var a=e.JavaScript.valueToCode(t,"STRING",e.JavaScript.ORDER_MEMBER)||"''",r=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),n=e.JavaScript.valueToCode(t,"AT1",e.JavaScript.ORDER_NONE)||"1";return t=e.JavaScript.valueToCode(t,"AT2",e.JavaScript.ORDER_NONE)||"1",[r=="FIRST"&&i=="LAST"?a:e.JavaScript.provideFunction_("text_get_substring",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text, where1, at1, where2, at2) {","  function getAt(where, at) {","    if (where == 'FROM_START') {","      at--;","    } else if (where == 'FROM_END') {","      at = text.length - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = text.length - 1;","    } else {","      throw 'Unhandled option (text_getSubstring).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return text.slice(at1, at2);","}"])+"("+a+", '"+r+"', "+n+", '"+i+"', "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_changeCase=function(t){var a={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return a?(t=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''",t+=a):(a=e.JavaScript.provideFunction_("text_toTitleCase",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"]),t=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''",t=a+"("+t+")"),[t,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_trim=function(t){var a={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_print=function(t){return"window.alert("+(e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''")+`);
`},e.JavaScript.text_prompt_ext=function(t){var a="window.prompt("+(t.getField("TEXT")?e.JavaScript.quote_(t.getFieldValue("TEXT")):e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''")+")";return t.getFieldValue("TYPE")=="NUMBER"&&(a="parseFloat("+a+")"),[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_prompt=e.JavaScript.text_prompt_ext,e.JavaScript.variables={},e.JavaScript.variables_get=function(t){return[e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.variables_set=function(t){var a=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_ASSIGNMENT)||"0";return e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+a+`;
`},e.JavaScript};const s=u(v),O=R({__proto__:null,default:s},[v]);export{O as j};
