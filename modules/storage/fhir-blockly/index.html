<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/9.9.2/jsoneditor.min.css" rel="stylesheet"
        type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/9.9.2/jsoneditor.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .gear {
            animation: rotate 1s linear infinite;
        }
    </style>
    <title>CCDA to FHIR</title>
  <script type="module" crossorigin src="/assets/index-CGc0dV5S.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-CAfrDKHo.css">
</head>

<body>
    <div class="p-3 bg-white">
        <span class="text-xl text-centerfont-bold">
            <span class="font-bold mr-1">Convert</span>
            From
            <select class="border rounded-md mr-1" id="switchFrom">
            </select>
            To
            <select class="border rounded-md ml-1" id="switchTo">
            </select>
        </span>
        <button id="panelToggleButton" class="float-right ml-1 rounded-md bg-blue-800 px-2 py-1 text-sm text-white">Open
            List Mapping</button>
    </div>
    <hr class="mb-2" />
    <div class="layout">
        <div class="json-editor">
            <h2 class="text-lg"><span id="switchFromTitle">Source</span> Document (Json format)</h2>
            <div id="leftJsonEditor" class="h-full"></div>
        </div>
        <div class="blockly-workspace">
            <h2 class="text-lg">
                Blockly Workspace (Visual Mapping)
            </h2>
            <div class="relative">
                <div id="preloaderBlockly"
                    class="flex items-center justify-center absolute inset-0 bg-white z-50 opacity-80">
                    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-blue-500"></div>
                </div>
                <div id="blocklyDiv"></div>
            </div>

            <div class="bg-white block-wrapper p-4 mt-5 controls-wrapper">
                <div class="flex w-full justify-between">
                    <div class="flex row-auto items-center">
                        <label for="selectedTemplateName">Select Template:</label>
                        <select id="selectedTemplateName" class="rounded-md border py-1 px-2 border-gray-300"
                            style="width:180px"></select>
                        <button id="deleteTemplate" disabled
                            class="ml-1 rounded-md bg-blue-800 px-2 py-1 text-sm text-white disabled:bg-gray-400 disabled:cursor-not-allowed">Delete
                            Template</button>
                    </div>
                    <div class="flex row-auto items-center">
                        <!-- <button id="discardDraft" disabled class="ml-1 rounded-md bg-blue-800 px-2 py-1 text-sm text-white disabled:bg-gray-400 disabled:cursor-not-allowed">Discard Draft</button> -->
                        <!-- <button id="publishTemplate" disabled class="ml-2 rounded-md bg-blue-800 min-w-[61px] px-2 py-1 text-sm text-white h-8 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-1">
              <svg id="publishButtonLoader" class="hidden" width="14" height="14" viewBox="0 0 50 50"> 
                <circle cx="25" cy="25" r="20" fill="none" stroke="white" stroke-width="4" stroke-dasharray="100" stroke-linecap="round">
                  <animateTransform attributeType="XML" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.8s" repeatCount="indefinite" />
                </circle>
              </svg>
              <span id="publishButtonText">Publish</span>
            </button> -->
                    </div>
                </div>
                <hr class="my-3 mb-3" />
                <div class="flex w-full justify-between">
                    <div>
                        <label for="versionList">View Versions:</label>
                        <select id="versionList" class="rounded-md border py-1 px-2 border-gray-300"
                            style="width:170px">
                            <option value="" disabled selected>Select an item</option>
                        </select>
                    </div>
                </div>
                <hr class="my-3 mb-3" />
                <div class="flex w-full justify-between">
                    <div class="flex items-start">
                        <div class="flex flex-col">
                            <span>Template Name</span>
                            <input type="text" id="templatename" class="rounded-md border py-1 px-2 border-gray-300"
                                style="width:180px" />
                            <p class="text-red-500 hidden" id="invalidMessageText">Template name already exists.</p>
                        </div>
                        <div class="flex flex-col">
                            <span class="ml-2">Template Description</span>
                            <input type="text" id="templateDescription"
                                class="rounded-md border py-1 px-2 border-gray-300 ml-2" style="width:300px" />
                        </div>
                        <button id="saveAsDraft"
                            class="flex items-center justify-center min-w-[100px] min-h-[28px] ml-2 mt-4 rounded-md bg-yellow-400 px-2 py-1 text-sm text-black h-8 disabled:bg-gray-400 disabled:cursor-not-allowed">
                            <svg id="saveAsDraftLoader" class="hidden" width="14" height="14" viewBox="0 0 50 50">
                                <circle cx="25" cy="25" r="20" fill="none" stroke="black" stroke-width="4"
                                    stroke-dasharray="100" stroke-linecap="round">
                                    <animateTransform attributeType="XML" attributeName="transform" type="rotate"
                                        from="0 25 25" to="360 25 25" dur="0.8s" repeatCount="indefinite" />
                                </circle>
                            </svg>
                            <span id="saveAsDraftButtonText">Save As Draft</span>
                        </button>

                    </div>
                </div>
                <hr class="my-3 mb-3" />
                <div class="flex">
                    <button disabled id="generateFHIRJson"
                        class="min-w-[150px] min-h-[28px] rounded-md bg-blue-800 px-2 py-1 text-sm text-white mt-1 disabled:bg-gray-400 disabled:cursor-not-allowed">Preview
                        And Validate</button>
                    <button disabled id="saveScript"
                        class="flex items-center justify-center min-w-[165px] min-h-[28px] ml-1 rounded-md bg-blue-800 px-2 py-1 text-sm text-white mt-1 disabled:bg-gray-400 disabled:cursor-not-allowed">
                        <svg id="saveScriptLoader" class="hidden" width="14" height="14" viewBox="0 0 50 50">
                            <circle cx="25" cy="25" r="20" fill="none" stroke="white" stroke-width="4"
                                stroke-dasharray="100" stroke-linecap="round">
                                <animateTransform attributeType="XML" attributeName="transform" type="rotate"
                                    from="0 25 25" to="360 25 25" dur="0.8s" repeatCount="indefinite" />
                            </circle>
                        </svg>
                        <span id="saveScriptButtonText">Save Script And Publish</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="json-editor">
            <h2 class="text-lg"><span id="switchToTitle">Converted</span> Document (Json format)</h2>
            <div id="rightJsonEditor" class="h-full"></div>
        </div>
    </div>

    <div id="toaster"
        class="fixed top-5 right-5 z-[9999] p-4 rounded shadow-md toaster w-96 flex items-center space-x-3">
        <div id="icon" class="text-xl"></div>
        <span id="toasterMessage" class="font-bold text-gray-800"></span>
    </div>

    <div id="closeButtonToast"
        class="fixed top-5 right-5 z-[9999] p-4 rounded shadow-md toaster w-96 flex items-center space-x-3">
        <div id="closeButtonToastStatusIcon" class="text-xl"></div>
        <span id="closeButtonToastMessage" class="font-bold text-gray-800"></span>
    </div>

    <div id="rightPanel" class="panel">
        <button class="close-btn float-right" id="panelCloseButton">X</button>
        <h2 class="text-xl">List Mapping</h2>
        <p class="mt-2">Select the namespace to map.</p>
        <hr class="mb-5" />
        <div class="flex w-full h-auto">
            <div id="sourceList" class="w-1/2 float-left">
                <h3 id="sourceListSelectorTitle" class="font-bold">CCDA</h3>
                <select class="rounded-md border mb-2 bg-blue-100 w-full" id="sourceListSelector"></select>
                <ul class="p-2 pt-0" id="sourceListSubNode"></ul>
            </div>
            <div class="w-16">
                <canvas id="connectionCanvas" style="position: absolute; top: 0; left: 0; z-index: -1;"></canvas>
            </div>
            <div id="targetList" class="w-1/2 float-right">
                <h3 id="targetListSelectorTitle" class="font-bold">FHIR</h3>
                <select class="border rounded-md bg-blue-100 w-full mb-2" id="targetListSelector"></select>
                <ul class="p-2 pt-0" id="targetListSubNode"></ul>
            </div>
        </div>
        <button class="bg-blue-700 text-white font-bold py-1 px-4 rounded-full mt-2 items-center"
            id="listMappingAddButton">Add</button>
    </div>

    <div id="errorPopup"
        class="hidden fixed bottom-[5px] right-[5px] ml-[10px] bg-white border border-red-200 rounded-lg shadow-md overflow-hidden z-50 flex-col w-[250px] h-auto">
        <div class="flex justify-between items-center px-5 py-3 bg-red-50 border-b border-red-200">
            <h4 id="popupTitle" class="font-semibold text-sm text-red-700">
                Validation errors
                <span id="errorCountHeader" class="font-semibold text-sm text-red-700"></span>
            </h4>
            <h3></h3>
            <div class="flex items-center space-x-2">
                <button id="toggleBtn" title="Maximize"></button>
                <button id="closeBtn" class="h-[24px]" title="Close"></button>
            </div>
        </div>
        <div id="popupBody" class="p-5 overflow-y-auto bg-white">
            <!-- Error messages will go here -->
        </div>
    </div>

    <div id="preloaderMain" class="flex items-center justify-center fixed inset-0 bg-white z-50">
        <!-- Gear Wheel -->
        <svg class="gear h-20 w-20 text-blue-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path
                d="M12 2v4M4.93 4.93l2.83 2.83M2 12h4M4.93 19.07l2.83-2.83M12 22v-4M19.07 19.07l-2.83-2.83M22 12h-4M19.07 4.93l-2.83 2.83" />
        </svg>
    </div>

</body>

</html>